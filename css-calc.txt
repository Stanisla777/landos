// tooltipMobile.js

import bodyLockMobileFilter from './redesign-site/body-lock-mobile-filter';
import bodyUnlockMobileFilter from './redesign-site/body-unlock-mobile-filter';

// ðŸ‘‡ Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚Ð¸Ñ€ÑƒÐµÐ¼ Ð½Ð°Ð¿Ñ€ÑÐ¼ÑƒÑŽ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ Ñ€Ð°Ð·Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸ body
import { RemoveClassBody } from './allow-body-scrolling'; // â† ÑƒÐºÐ°Ð¶Ð¸Ñ‚Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ Ð¿ÑƒÑ‚ÑŒ

function openTooltipMobile() {
  const array_mobile_tooltip = document.querySelectorAll('.js--open-mobile-tooltip');
  for (let item of array_mobile_tooltip) {
    item.onclick = () => {
      const parent = item.closest('.js--tooltip-parent');
      if (parent) {
        parent.classList.add('active');
        bodyLockMobileFilter(parent);
      }
    };
  }
}

function closeTooltipMobile() {
  const array_mobile_tooltip_close = document.querySelectorAll('.js--close-mobile-tooltip');
  for (let item of array_mobile_tooltip_close) {
    item.onclick = () => {
      const parent = item.closest('.js--tooltip-parent');
      if (parent) {
        parent.classList.remove('active');
        bodyUnlockMobileFilter(parent);
      }
    };
  }
}

// ðŸ”¥ ÐÐ¾Ð²Ð°Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ: Ð·Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ Ð²ÑÑ‘ Ð¸ Ð³Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð¾ Ñ€Ð°Ð·Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ body
function closeAllMobileTooltips() {
  const activeParents = document.querySelectorAll('.js--tooltip-parent.active');
  if (activeParents.length > 0) {
    // Ð¡Ð½Ð°Ñ‡Ð°Ð»Ð° ÑƒÐ±Ð¸Ñ€Ð°ÐµÐ¼ active Ñƒ Ð²ÑÐµÑ…
    activeParents.forEach(parent => {
      parent.classList.remove('active');
    });

    // Ð—Ð°Ñ‚ÐµÐ¼ â€” Ð¿Ñ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ñ€Ð°Ð·Ð±Ð»Ð¾ÐºÐ¸Ñ€ÑƒÐµÐ¼ body
    // (Ð´Ð°Ð¶Ðµ ÐµÑÐ»Ð¸ bodyUnlockMobileFilter ÑÑ‚Ð¾Ð³Ð¾ Ð½Ðµ ÑÐ´ÐµÐ»Ð°ÐµÑ‚)
    RemoveClassBody();
  }
}

// ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ñ€ÐµÑÐ°Ð¹Ð·Ð°
function handleResize() {
  // ÐŸÐ¾Ñ€Ð¾Ð³ Ð¸Ð· Ð²Ð°ÑˆÐ¸Ñ… Ð¼ÐµÐ´Ð¸Ð°Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð²: 480px
  if (window.innerWidth > 480) {
    closeAllMobileTooltips();
  }
}

// Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚
export default function tooltipMobile() {
  openTooltipMobile();
  closeTooltipMobile();

  // Ð¡Ð»ÑƒÑˆÐ°ÐµÐ¼ Ñ€ÐµÑÐ°Ð¹Ð·
  window.addEventListener('resize', handleResize);

  // ÐÐ° Ð²ÑÑÐºÐ¸Ð¹ ÑÐ»ÑƒÑ‡Ð°Ð¹: Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð¿Ñ€Ð¸ Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸
  if (window.innerWidth > 480) {
    closeAllMobileTooltips();
  }
}
