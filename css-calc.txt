if (isNote) {
  notes.forEach(item => {
    item.classList.remove('active');
    const text = item.querySelector('.content-note__text');
    text.classList.remove('active');
    text.classList.remove('up');
    text.classList.remove('down');
  });

  const noteText = e.target.querySelector('.content-note__text');
  const rect = e.target.getBoundingClientRect();
  const windowHeight = window.innerHeight;
  const topOffset = rect.top + rect.height / 2;

  // === ðŸ”¥ Ð¡Ð½Ð°Ñ‡Ð°Ð»Ð° Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÐ¼ Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ (up/down) Ð¸ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ ÐºÐ»Ð°ÑÑÑ‹ ===
  if (windowHeight / 2 > topOffset) {
    noteText.classList.add('down');
    noteText.classList.remove('up');
  } else {
    noteText.classList.add('up');
    noteText.classList.remove('down');
  }

  // === ðŸ”¥ Ð¡ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ Ð²Ð¸Ð·ÑƒÐ°Ð»ÑŒÐ½Ð¾, Ð½Ð¾ Ð´ÐµÐ»Ð°ÐµÐ¼ Ð¸Ð·Ð¼ÐµÑ€Ð¸Ð¼Ñ‹Ð¼ ===
  noteText.style.visibility = 'hidden';
  noteText.style.opacity = '0';
  noteText.style.transition = 'none';

  // === ðŸ”¥ ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚ (Ð½Ð¾ Ð½ÐµÐ²Ð¸Ð´Ð¸Ð¼Ð¾) ===
  e.target.classList.add('active');
  noteText.classList.add('active');

  // === ðŸ”¥ ÐŸÐ¾Ð·Ð¸Ñ†Ð¸Ð¾Ð½Ð¸Ñ€ÑƒÐµÐ¼ â€” Ñ‚ÐµÐ¿ÐµÑ€ÑŒ Ð·Ð½Ð°ÐµÑ‚, Ñ‡Ñ‚Ð¾ ÐºÐ»Ð°ÑÑ up/down ÑƒÐ¶Ðµ ÐµÑÑ‚ÑŒ ===
  positionTooltip(e.target);

  // === ðŸ”¥ ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ñ Ð°Ð½Ð¸Ð¼Ð°Ñ†Ð¸ÐµÐ¹ ===
  requestAnimationFrame(() => {
    requestAnimationFrame(() => {
      noteText.style.visibility = 'visible';
      noteText.style.opacity = '1';
      noteText.style.transition = 'opacity 0.2s ease, transform 0.2s ease';
    });
  });
}
