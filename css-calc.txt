general.js

/* eslint-disable */
import Vue from 'vue';
import IMask from 'imask'
import selectsInit from './modules/selects-init';
import catalogNew from './modules/catalog-new';
import universalForm from './modules/universal-form/universal-form';
import leftSideBar from './modules/redesign-site/left-side-bar';
import headerMenu from './modules/redesign-site/header-menu';
import yandexSearch from './modules/redesign-site/yandex-search';
import anchors from './modules/anchors';
import {
  modals, closeModal, catalogModal
} from './modules/modals';
import cookies from './modules/cookies';
import playVideo from './modules/video/play-video';
import videoWithPreview from './modules/video/video-with-preview';
import footerDropDown from './modules/redesign-site/footer-drop-down';
import fetchLikes from './modules/fetch-likes';
import scrollToUp from './modules/redesign-site/scroll-to-up';

Vue.config.productionTip = false;
window.selectsInit = selectsInit;

document.addEventListener('DOMContentLoaded', () => {
  window.closeModal = closeModal;
  window.modals = modals;
  window.fetchLikes = fetchLikes;
  // window.selectsInit = selectsInit;
  window.universalForm = universalForm;
  selectsInit();
  catalogNew();
  leftSideBar();
  headerMenu();
  yandexSearch();
  catalogModal();
  modals();
  anchors();
  cookies();
  playVideo();
  videoWithPreview();
  universalForm();
  footerDropDown();
  fetchLikes();
  scrollToUp();
  // IMask()
  // testPollsSlider();
})

------------------------------------------------------------
instruction.js
/* eslint-disable */

// Ленивая загрузка — только если нужны элементы инструкций
// src/js/instruction.js
document.addEventListener('DOMContentLoaded', () => {
  require.ensure([], (require) => {
    require('./lazy-instruction.js');
    console.log('✅ Instruction modules loaded');
  }, 'instruction-lazy');
});

-------------------------------------------------
lazy-instruction.js

/* eslint-disable */
import Vue from 'vue';
//import TestN from './modules/test-n/TestNPointEntry.vue';
// import VPolls from './modules/polls/MainPolls.vue';
import initializationPolls from './modules/polls/custom-scripts/initialization-polls';
import SearchFamilyMortgage from './modules/search-family-mortgage/SearchFamilyMortgagePointEntry.vue';
import ItMortgageSurveysOneRequest from './modules/it-mortgage-surveys-one-request/ITMortgageSurveysPointEntry.vue';
import MinSport from './modules/minsport/MinsportPointEntry.vue';
import contentNote from './modules/content-note';
import dropDown from './modules/dropDown';
import {
  testPollsSlider, authorsSlider, cardSlider, cardSliderfoufcolumn,
} from './modules/swiper-sliders';
import slideConstructor from './modules/constructor-swiper';
import formRating from './modules/form-rating';
import popupGallery from './modules/popup-gallery';
import shareSocList from './modules/share-soc-list';
import TelegramBlock from './modules/TelegramBlock.vue';

function dropDownTags() {
  const btnTags = document.querySelectorAll('.js--dropDown-btn');
  for (const item of btnTags) {
    item.onclick = (el) => {
      dropDown(el.target, 0);
    };
  }
}

// Вся инициализация — теперь здесь
export function init() {
  contentNote();
  dropDownTags();
  slideConstructor();
  testPollsSlider();
  initializationPolls();
  authorsSlider();
  formRating();
  cardSliderfoufcolumn();
  cardSlider();
  popupGallery();
  shareSocList();

  // Vue-аппы
  // const vueTestRoots = document.querySelectorAll('.js-test-n');
  // vueTestRoots.forEach((el, i) => {
  //   el.id = `test-n-${i}`;
  //   new Vue({ el: `#test-n-${i}`, components: { 'test-n': TestN } });
  // });

  const vueTestRoots = document.querySelectorAll('.js-test-n');
  if (vueTestRoots.length > 0) {
    require.ensure([], (require) => {
      const TestN = require('./modules/test-n/TestN.vue').default;
      vueTestRoots.forEach((el, i) => {
        el.id = `test-n-${i}`;
        new Vue({ el: `#test-n-${i}`, components: { 'test-n': TestN } });
      });
    }, 'test-n-lazy');
  }

  // const vuePolls = document.querySelectorAll('.js-polls-n');
  // if (vuePolls.length) {
  //   for (let i = 0; i < vuePolls.length; i += 1) {
  //     vuePolls[i].classList.add(`js__polls-n-${i}`);
  //
  //     // eslint-disable-next-line no-new
  //     new Vue({
  //       el: `.js__polls-n-${i}`,
  //       components: {
  //         'v-polls': VPolls,
  //       }
  //     });
  //   }
  // }

  // Ленивая загрузка VPolls — только если есть элементы
  const vuePolls = document.querySelectorAll('.js-polls-n');
  if (vuePolls.length > 0) {
    require.ensure([], (require) => {
      const VPolls = require('./modules/polls/MainPolls.vue').default;
      vuePolls.forEach((el, i) => {
        el.classList.add(`js__polls-n-${i}`);
        new Vue({
          el: `.js__polls-n-${i}`,
          components: { 'v-polls': VPolls }
        });
      });
    }, 'v-polls-lazy');
  }

  // Инициализация по ID
  function initSearchFamilyMortgage() {
    new Vue({
      el: '#search-family-mortgage',
      components: { 'search-family-mortgage': SearchFamilyMortgage }
    });
  }

  function initItMortgageSurveysOneRequest() {
    new Vue({
      el: '#v-mortgage-surveys-one-request',
      components: { 'it-mortgage-surveys-one-request': ItMortgageSurveysOneRequest }
    });
  }

  function initMinSport() {
    new Vue({
      el: '#v-minsport',
      components: { 'min-sport': MinSport }
    });
  }

  const obj = [
    { id: 'search-family-mortgage', fn: initSearchFamilyMortgage },
    { id: 'v-mortgage-surveys-one-request', fn: initItMortgageSurveysOneRequest },
    { id: 'v-minsport', fn: initMinSport },
    { id: 'form-rating', fn: formRating },
  ];

  function waitForVueApp(id, initFn) {
    const el = document.getElementById(id);
    if (el && !el.__vue_initialized) {
      initFn();
      el.__vue_initialized = true;
      return;
    }

    const observer = new MutationObserver(() => {
      const element = document.getElementById(id);
      if (element && !element.__vue_initialized) {
        observer.disconnect();
        initFn();
        element.__vue_initialized = true;
      }
    });

    observer.observe(document.body, { childList: true, subtree: true });
  }

  obj.forEach(item => waitForVueApp(item.id, item.fn));
}

// Автозапуск при импорте
init();

export default { init };

--------------------------------------------------------------------

index.js
import Vue from 'vue';
import TelegramBlock from './modules/TelegramBlock.vue';

document.addEventListener('DOMContentLoaded', () => {
function initTelegramBlock() {
        // eslint-disable-next-line no-new
        new Vue({
            el: '#telegram-block',
            components: {
                'telegram-block': TelegramBlock
            }
        });
    }
const obj = [
 {
   id: 'telegram-block',
   fn: initTelegramBlock
  }
]
function waitForVueApp(id, initFn) {
    const el = document.getElementById(id);
    // eslint-disable-next-line no-underscore-dangle
    if (el && !el.__vue_initialized) {
      initFn();
      // eslint-disable-next-line no-underscore-dangle
      el.__vue_initialized = true;
      return;
    }

    const observer = new MutationObserver(() => {
      const element = document.getElementById(id);
      // eslint-disable-next-line no-underscore-dangle
      if (element && !element.__vue_initialized) {
        observer.disconnect();
        initFn();
        // eslint-disable-next-line no-underscore-dangle
        element.__vue_initialized = true;
      }
    });

    observer.observe(document.body, { childList: true, subtree: true });
  }
obj.forEach((item) => {
    waitForVueApp(item.id, item.fn);
  });

});
