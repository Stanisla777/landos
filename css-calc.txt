//кнопка отправить расчёт
    async copyLink(event){
      const link = event.currentTarget.dataset.link;
      const element = event.currentTarget

      try{
        if (navigator.clipboard){
          await navigator.clipboard.writeText(link);
          element.querySelector('p').textContent='Скопировано';
          setTimeout(()=>{
            element.querySelector('p').textContent='Скопировать ссылку';
          },3000)
        } else {
          throw new Error ('not supported')
        }

      } catch (err) {
        const texarea = document.createElement('textarea');
        texarea.value = link;
        texarea.style.position='fixed';
        document.body.appendChild(texarea)
        texarea.select();
        document.execCommand('copy')
        document.body.removeChild(texarea)
        console.log('Ошибка копирования');
        console.log(err);
      }

    },


    //-------ОТПРАВКА-----------------------

    //Поделиться
    sendingResultsClick(el){
      const element = el.target;
      if (element.classList.contains('js--calc-shedule-footer-share')){
        if (this.can_share===1 && this.flag_send_results===true) {
          // this.sendingResult('result');//для финальной отправки нужно это
          this.sendingResultToApi(888)//это не нужно
        }
      }
    },


    sendingResult(flag){
      this.captchaInit(flag);
      let recaptchaKey = null;
      if(typeof conf !== 'undefined'){
        recaptchaKey = conf.smartcaptcha_key
      }
      if ((typeof recaptchaKey !== 'undefined') && recaptchaKey!==null) {
        window.smartCaptcha.execute(this.captcha_id);
      }
    },
    captchaInit(flag) {
      this.captcha_id = window.smartCaptcha.render('yandex-captcha-family-calculator', {
        sitekey: conf.smartcaptcha_key,
        invisible: true,
        callback: (token) => {
          if (flag==='result'){
            this.sendingResultToApi(token)
          }
          if (flag==='mail') {
            this.sendingMailToApi(token)
          }
        },
      });
    },

    //отправка расчётов
    sendingResultToApi(token){
      let data = {
        "calculatorId": this.calculatorId,
        "answers": this.answersToSand,
        "smart-token": token
      }

      axios({
        method:'post',
        url:'/api/',

        headers: {
          "Content-type": "application/json; charset=UTF-8",
          'X-Bitrix-Csrf-Token': window.BX.bitrix_sessid(),
        },

        data:data
      })
        .then((res)=>{
          if(res.data.code===200&&res.data.result){

            Storage.dispatch('ActionDescriptionAfterSand',null)
            Storage.dispatch('ActionAnswersId',res.data.result.answersId)
            Storage.dispatch('ActionAnswerLink',res.data.result.answerLink)
          }
          if (res.data.code!==200) {
            if (res.data.description) {
              Storage.dispatch('ActionDescriptionAfterSand',res.data.description)
            }
            if (res.data.code) {
              this.answer_code=res.data.code
            }
          }
          this.answersToSand=[]
        })

        //Если запрос с ошибкой
        .catch((error)=> {
          if(error.response){
            if (error.response.data!==undefined){
              console.log(error.response);
              Storage.dispatch('ActionDescriptionAfterSand',error.response.data.description)
            }
          }
          // state.preload_btn=false
          console.log(error);
        });
    },

    //отправка mail
    sendingMailToApi(token){
      const modal_main_content = this.$refs.dataModalMail.querySelector('.js--modal-main-content')
      const modal_success_content = this.$refs.dataModalMail.querySelector('.js--modal-wr-success')
      const modal_failed_content = this.$refs.dataModalMail.querySelector('.js--modal-wr-failed')
      let data = {
        "userEmail":this.mask_mail.value,
        "smart-token":token,
        "answersId":this.answersId,
        "agree":this.check_agree_advertisement
      }

      //это для тестирования

      // setTimeout(()=>{
      //
      //   if (modal_main_content) {
      //     modal_main_content.classList.add('unactive')
      //   }
      //   if (modal_failed_content) {
      //     modal_failed_content.classList.add('active')
      //   }
      //   this.description_after_sand_mail="Ошибка!!!!!"
      //
      // },500)

      // ---------------------------------------


      axios({
        method:'post',
        url:'/api/local/calculator/answers/sendmail/',
        headers: {
          "Content-type": "application/json; charset=UTF-8",
          'X-Bitrix-Csrf-Token': window.BX.bitrix_sessid(),
        },
        data: data
      })
        .then((res)=>{
          if (modal_main_content) {
            modal_main_content.classList.add('unactive')
          }
          if (modal_success_content) {
            modal_success_content.classList.add('active')
          }

        })

        //Если запрос с ошибкой
        .catch((error)=> {
          if (error.response.data!==undefined&&error.response.data.description!==undefined){
            console.log(error.response);
            this.description_after_sand_mail=error.response.data.description
          }
          // state.preload_btn=false
          console.log(error);
          if (modal_main_content) {
            modal_main_content.classList.add('unactive')
          }
          if (modal_failed_content) {
            modal_failed_content.classList.add('active')
          }
        });

    },
