optimization: {
  minimize: true,
  minimizer: [
    new TerserPlugin({
      parallel: true,
      cache: true
    })
  ],
  splitChunks: {
    chunks: 'all', // ← Анализировать все чанки
    cacheGroups: {
      // Отключаем автоматические vendor-чанки
      defaultVendors: false,

      // Legacy-бандл: всё внутри
      legacy: {
        name: 'all',
        chunks: 'initial',
        test: /[\\/]src[\\/]/, // только ваш код
        enforce: true
      },

      // Новые страницы: выносим vendor
      vendor: {
        test: /[\\/]node_modules[\\/](vue|axios|vue-axios|swiper|imask)[\\/]/,
        name: 'vendor-script',
        chunks: (chunk) => ['general-js', 'instruction-js', 'instruction-lazy'].includes(chunk.name),
        enforce: true
      }
    }
  }
}
