–î–µ–º–æ-—Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å –≤–∏–¥–µ–æ:
https://rssprosi-3100.sprosi.dev.ringsites.ahml.ru/education/video/testovoe-video-ot-vkvideo-ru/
https://rssprosi-3100.sprosi.dev.ringsites.ahml.ru/education/video/testovoe-video-ot-rutube-ru/

–í–∏–¥–µ–æ —Å –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏:

https://rssprosi-3100.sprosi.dev.ringsites.ahml.ru/education/video/sberezhenie-sredstv-v-krizisnoy-situatsii/

https://rssprosi-3100.sprosi.dev.ringsites.ahml.ru/education/video/keshbek-dlya-zhizni-kak-vernut-potrachennye-dengi/



// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
let activeDropdown = null;
let activeTrigger = null;
let popupContainer = null;

// –°–æ–∑–¥–∞—ë–º –æ–±—â–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –æ–¥–∏–Ω —Ä–∞–∑
function ensurePopupContainer() {
  if (!popupContainer) {
    popupContainer = document.createElement('div');
    popupContainer.className = 'soc-share-popup-container';
    Object.assign(popupContainer.style, {
      position: 'fixed',
      top: '0',
      left: '0',
      width: '100%',
      height: '100%',
      pointerEvents: 'none',
      zIndex: '2147483647', // –∫–∞–∫ —É –Ø–Ω–¥–µ–∫—Å–∞ ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π
    });
    document.body.appendChild(popupContainer);
  }
  return popupContainer;
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–Ω–æ–ø–æ–∫
export default function shareSocList() {
  const triggers = document.querySelectorAll('.js--soc-list-share:not([data-initialized])');
  triggers.forEach(trigger => {
    trigger.dataset.initialized = 'true';
    trigger.addEventListener('click', handleShareClick);
  });
}

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞
function handleShareClick(e) {
  e.preventDefault();
  const trigger = e.currentTarget;
  const wrapper = trigger.closest('.js--soc-list-wrapper-share');
  if (!wrapper) return;

  // –ó–∞–∫—Ä—ã–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π popup (–µ—Å–ª–∏ –µ—Å—Ç—å)
  if (activeDropdown) {
    hideDropdown(activeDropdown);
  }

  // –°–æ–∑–¥–∞—ë–º –∏–ª–∏ –Ω–∞—Ö–æ–¥–∏–º popup –¥–ª—è —ç—Ç–æ–≥–æ wrapper‚Äô–∞
  let dropdown = wrapper.querySelector('.soc-list__share');
  if (!dropdown) {
    dropdown = createShareDropdown(wrapper);
    // –í—Å—Ç–∞–≤–ª—è–µ–º –≤ –≥–ª–æ–±–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –∞ –Ω–µ –≤ wrapper!
    ensurePopupContainer().appendChild(dropdown);
  }

  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º
  showDropdown(dropdown, trigger);
}

// –ü–æ–∫–∞–∑ popup‚Äô–∞
function showDropdown(dropdown, trigger) {
  // –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º: —Å–∫—Ä—ã—Ç, –Ω–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ–º
  dropdown.style.opacity = '0';
  dropdown.style.pointerEvents = 'none';

  // –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ–º (–±–µ–∑ –∞–Ω–∏–º–∞—Ü–∏–∏!)
  positionDropdown(trigger, dropdown);

  // –ü–ª–∞–≤–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º
  requestAnimationFrame(() => {
    dropdown.style.transition = 'opacity 0.2s ease';
    dropdown.style.opacity = '1';
    dropdown.style.pointerEvents = 'auto';
  });

  // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º "–ø—Ä–∏–ª–∏–ø–∞–Ω–∏–µ"
  activeDropdown = dropdown;
  activeTrigger = trigger;
  window.addEventListener('scroll', onScroll, { passive: true });
}

// –°–∫—Ä—ã—Ç–∏–µ popup‚Äô–∞
function hideDropdown(dropdown) {
  if (!dropdown) return;

  dropdown.style.transition = 'opacity 0.2s ease';
  dropdown.style.opacity = '0';
  dropdown.style.pointerEvents = 'none';

  setTimeout(() => {
    dropdown.style.display = 'none';
    dropdown.style.transform = ''; // —Å–±—Ä–æ—Å
  }, 200);

  activeDropdown = null;
  activeTrigger = null;
  window.removeEventListener('scroll', onScroll);
}

// –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ popup‚Äô–∞ (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ, –±–µ–∑ transition!)
function positionDropdown(trigger, dropdown) {
  const rect = trigger.getBoundingClientRect();
  const top = rect.top + rect.height + 10; // –æ—Ç—Å—Ç—É–ø 10px
  const left = rect.left;

  // üîë –¢–æ–ª—å–∫–æ transform ‚Äî –±–µ–∑ top/left, –±–µ–∑ transition
  dropdown.style.transform = `translate(${left}px, ${top}px)`;
}

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–∫—Ä–æ–ª–ª–∞ ‚Äî –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π, –∫–∞–∫ —É –Ø–Ω–¥–µ–∫—Å–∞
function onScroll() {
  if (activeDropdown && activeTrigger) {
    positionDropdown(activeTrigger, activeDropdown);
  }
}

// –°–æ–∑–¥–∞–Ω–∏–µ popup‚Äô–∞ (–≤–Ω—É—Ç—Ä–∏ fixed-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞)
function createShareDropdown(wrapper) {
  // === –ü–∞—Ä—Å–∏–Ω–≥ data-services ===
  const servicesStr = (wrapper.dataset.services || '').trim();
  let services = [];
  if (servicesStr) {
    try {
      services = JSON.parse(servicesStr);
    } catch (_) {
      let cleaned = servicesStr.trim();
      if (cleaned.startsWith('[') && cleaned.endsWith(']')) {
        cleaned = cleaned.slice(1, -1).trim();
      }
      services = cleaned.split(',').map(s => s.trim()).filter(Boolean);
    }
  }
  if (!Array.isArray(services)) services = [];

  // === –î–∞–Ω–Ω—ã–µ ===
  const rawUrl = wrapper.dataset.url || location.href;
  const rawText = wrapper.dataset.text || document.title;
  const rawImage = wrapper.dataset.image || '';

  const url = encodeURIComponent(rawUrl);
  const text = encodeURIComponent(rawText);
  const imageUrl = encodeURIComponent(rawImage);

  // === DOM ===
  const dropdown = document.createElement('div');
  dropdown.className = 'soc-list__share';
  Object.assign(dropdown.style, {
    position: 'absolute',
    top: '0',
    left: '0',
    opacity: '0',
    pointerEvents: 'none',
    // transition ‚Äî —Ç–æ–ª—å–∫–æ –¥–ª—è opacity, –Ω–µ –¥–ª—è transform!
  });

  const ul = document.createElement('ul');
  ul.style.margin = '0';
  ul.style.padding = '0';
  ul.style.listStyle = 'none';

  const serviceTitles = {
    whatsapp: 'WhatsApp',
    telegram: 'Telegram',
    vkontakte: '–í–ö–æ–Ω—Ç–∞–∫—Ç–µ',
    odnoklassniki: '–û–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∏',
  };

  services.forEach(service => {
    const title = serviceTitles[service];
    if (!title) return;

    const li = document.createElement('li');
    li.style.margin = '2px 0';

    const a = document.createElement('a');
    a.href = getShareUrl(service, { url, text, imageUrl });
    a.target = '_blank';
    a.rel = 'noopener noreferrer';
    a.style.display = 'flex';
    a.style.alignItems = 'center';
    a.style.gap = '10px';
    a.style.padding = '6px 12px';
    a.style.textDecoration = 'none';
    a.style.color = 'inherit';

    const icon = document.createElement('div');
    icon.className = `soc-list__share-icon ${service}-icon-share`;
    icon.style.width = '24px';
    icon.style.height = '24px';
    icon.style.backgroundSize = 'contain';
    icon.style.backgroundRepeat = 'no-repeat';
    icon.style.backgroundPosition = 'center';

    const span = document.createElement('span');
    span.className = 'soc-list__share-title';
    span.textContent = title;

    a.appendChild(icon);
    a.appendChild(span);
    li.appendChild(a);
    ul.appendChild(li);
  });

  // === –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Å—ã–ª–∫–∏ ===
  const copyLi = document.createElement('li');
  copyLi.style.margin = '2px 0';

  const copyDiv = document.createElement('div');
  copyDiv.className = 'soc-list__copy-link';
  copyDiv.dataset.copyLink = '';
  copyDiv.style.display = 'flex';
  copyDiv.style.alignItems = 'center';
  copyDiv.style.gap = '10px';
  copyDiv.style.padding = '6px 12px';
  copyDiv.style.cursor = 'pointer';

  const copyIcon = document.createElement('div');
  copyIcon.className = 'soc-list__share-icon copy-link';
  copyIcon.style.width = '24px';
  copyIcon.style.height = '24px';
  copyIcon.style.backgroundSize = 'contain';
  copyIcon.style.backgroundRepeat = 'no-repeat';
  copyIcon.style.backgroundPosition = 'center';

  const copyTitle = document.createElement('span');
  copyTitle.className = 'soc-list__share-title';
  copyTitle.textContent = '–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É';

  copyDiv.appendChild(copyIcon);
  copyDiv.appendChild(copyTitle);
  copyLi.appendChild(copyDiv);
  ul.appendChild(copyLi);

  dropdown.appendChild(ul);

  // === –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è ===
  copyDiv.addEventListener('click', function (ev) {
    ev.stopPropagation();

    const copy = () => {
      if (navigator.clipboard && typeof navigator.clipboard.writeText === 'function') {
        return navigator.clipboard.writeText(rawUrl);
      } else {
        const textarea = document.createElement('textarea');
        textarea.value = rawUrl;
        textarea.setAttribute('readonly', '');
        textarea.style.position = 'absolute';
        textarea.style.left = '-9999px';
        document.body.appendChild(textarea);
        textarea.select();
        const ok = document.execCommand('copy');
        document.body.removeChild(textarea);
        return ok ? Promise.resolve() : Promise.reject(new Error('copy failed'));
      }
    };

    copy()
      .then(() => {
        copyTitle.textContent = '–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ';
        // –ó–∞–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ 500 –º—Å ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ–≤–∞–µ—Ç –ø—Ä–æ—á–∏—Ç–∞—Ç—å
        setTimeout(() => {
          if (activeDropdown === dropdown) {
            hideDropdown(dropdown);
          }
        }, 500);
      })
      .catch(err => {
        console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å:', err);
        copyTitle.textContent = '–û—à–∏–±–∫–∞';
        setTimeout(() => {
          if (copyTitle.textContent === '–û—à–∏–±–∫–∞') {
            copyTitle.textContent = '–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É';
          }
        }, 1500);
      });
  });

  // === –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –Ω–∞ —Å–æ—Ü—Å–µ—Ç—å ===
  dropdown.addEventListener('click', (ev) => {
    if (ev.target.closest('a')) {
      hideDropdown(dropdown);
    }
  });

  // === –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ ===
  const onClickOutside = (ev) => {
    if (activeDropdown === dropdown && !dropdown.contains(ev.target) && !ev.target.closest('.js--soc-list-share')) {
      hideDropdown(dropdown);
    }
  };
  document.addEventListener('click', onClickOutside);

  // –û—Ç–ø–∏—Å–∫–∞ –ø—Ä–∏ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–∏ (–Ω–∞ –≤—Å—è–∫–∏–π)
  dropdown._cleanup = () => {
    document.removeEventListener('click', onClickOutside);
  };

  return dropdown;
}

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è share-—Å—Å—ã–ª–æ–∫
function getShareUrl(service, { url, text, imageUrl }) {
  switch (service) {
    case 'whatsapp':
      return `https://wa.me/?text=${text}%20${url}`;
    case 'telegram':
      return `https://t.me/share/url?url=${url}&text=${text}`;
    case 'vkontakte':
      return `https://vk.com/share.php?url=${url}&title=${text}&image=${imageUrl}&noparse=true`;
    case 'odnoklassniki':
      return `https://connect.ok.ru/offer?url=${url}&title=${text}&imageUrl=${imageUrl}`;
    default:
      return '#';
  }
}


--------------------------------------------------------------------------------------

.soc-share-popup-container {
  pointer-events: none;
}

.soc-list__share {
  position: absolute;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.2s ease;
  background: #fff;
  border-radius: 8px;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.18), 0 0 4px rgba(0, 0, 0, 0.1);
  padding: 8px 0;
  min-width: 200px;
  z-index: 2147483647;

  &.active {
    opacity: 1;
    pointer-events: auto;
  }

  ul {
    list-style: none;
    margin: 0;
    padding: 0;

    li {
      margin: 2px 0;
    }
  }

  a, .soc-list__copy-link {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 6px 12px;
    text-decoration: none;
    color: #000;
    cursor: pointer;

    &:hover {
      background-color: #f5f5f5;
    }
  }

  &-icon {
    width: 24px;
    height: 24px;
    background-size: contain;
    background-repeat: no-repeat;
    background-position: center;
    // –£–∫–∞–∂–∏—Ç–µ —Å–≤–æ–∏ –∏–∫–æ–Ω–∫–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä:
    // &.whatsapp-icon-share   { background-image: url('whatsapp.svg'); }
  }

  &-title {
    font-family: $ff-semi-bold, sans-serif;
    font-size: 14px;
    line-height: 20px;
  }
}








