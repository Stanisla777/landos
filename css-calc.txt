document.addEventListener('touchstart', (e) => {
  const isNote = e.target.classList.contains('js--content-note');
  const isNoteText = e.target.classList.contains('content-note__text') ||
                     e.target.closest('.content-note__text');

  if (isNoteText && !isNote) return;

  if (isNote && e.target.classList.contains('active')) {
    e.target.classList.remove('active');
    e.target.querySelector('.content-note__text').classList.remove('active');
    return;
  }

  if (!isNote) {
    notes.forEach(item => {
      item.classList.remove('active');
      item.querySelector('.content-note__text').classList.remove('active');
    });
    return;
  }

  if (isNote) {
    // Ð—Ð°ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ Ð²ÑÐµ
    notes.forEach(item => {
      item.classList.remove('active');
      item.querySelector('.content-note__text').classList.remove('active');
    });

    const noteText = e.target.querySelector('.content-note__text');

    // === ðŸ”¥ Ð¡Ð½Ð°Ñ‡Ð°Ð»Ð° Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¾Ð½Ð¸Ñ€ÑƒÐµÐ¼, ÐŸÐžÐšÐ Ñ‚ÑƒÐ»Ñ‚Ð¸Ð¿ ÐÐ• Ð²Ð¸Ð´ÐµÐ½ ===
    // Ð£Ð±ÐµÐ´Ð¸Ð¼ÑÑ, Ñ‡Ñ‚Ð¾ Ñ‚ÑƒÐ»Ñ‚Ð¸Ð¿ "Ð½ÐµÐ²Ð¸Ð´Ð¸Ð¼", Ð½Ð¾ Ð¸Ð·Ð¼ÐµÑ€Ð¸Ð¼Ñ‹Ð¹
    noteText.style.visibility = 'hidden';
    noteText.style.opacity = '0';
    noteText.style.transition = 'none'; // Ð¾Ñ‚ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Ð°Ð½Ð¸Ð¼Ð°Ñ†Ð¸ÑŽ Ð½Ð° Ð¿ÐµÑ€Ð²Ñ‹Ð¹ Ð¿Ð¾ÐºÐ°Ð·

    e.target.classList.add('active');
    noteText.classList.add('active');

    // ÐŸÐ¾Ð·Ð¸Ñ†Ð¸Ð¾Ð½Ð¸Ñ€ÑƒÐµÐ¼ Ð”Ðž Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ
    positionTooltip(e.target);

    // === Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ñ Ð°Ð½Ð¸Ð¼Ð°Ñ†Ð¸ÐµÐ¹ ===
    requestAnimationFrame(() => {
      requestAnimationFrame(() => {
        noteText.style.visibility = 'visible';
        noteText.style.opacity = '1';
        noteText.style.transition = 'opacity 0.2s ease, transform 0.2s ease';
      });
    });
  }
});
