#pdf-export-content.pdf__export-content(v-if = "shedule.length > 0")
      .pdf__page-inner
        // Шапка (будет клонироваться на каждую страницу)
        .pdf__header
          .pdf__header-col-des
            p Калькулятор досрочного погашения ипотеки
          .pdf__header-col-img
            img(src="img/pdf-logo-site.svg")
        //блок с меткой время расчёта
        .pdf__section.pdf__section-metrika
          p.pdf__font-size-16 Расчет платежей от {{currentDate}}
          a(href="https://xn--h1alcedd.xn--d1aqf.xn--p1ai/calculators/kalkulyator-dosrochnogo-pogasheniya-ipoteki/").pdf__link-new-calculation Сделать новый расчет
        .pdf__section.pdf__padding-16.pdf__section-information
          .pdf__section-information-img
            .pdf__section-information-img-icon
          p.
              Расчет носит справочный характер и не может быть основанием для совершения юридически значимых действий
        //Данные об ипотеке
        .pdf__section.pdf__padding-16.grey-border
          p.pdf__section-title Данные об ипотеке
          .pdf__row-block.mt24
            .pdf__col-block-50
              p.pdf__font-size-16.pdf__input-title Сумма кредита, ₽
              .pdf__block-with-data-radius
                p {{loanAmount | format_decimal}}
            .pdf__col-block-50
              p.pdf__font-size-16.pdf__input-title Дата получения
              .pdf__block-with-data-radius
                p {{obj_month[startMonth - 1] | capitalize}} {{startYear}}

          .pdf__row-block.mt24
            .pdf__col-block-50
              p.pdf__font-size-16.pdf__input-title Ставка, %
              .pdf__block-with-data-radius
                p {{annualInterestRate | replace_point}}
            .pdf__col-block-50
              p.pdf__font-size-16.pdf__input-title Срок кредита
              .pdf__block-with-data-radius
                p {{formattedTerm}}

          .pdf__row-block.mt24
            p.pdf__font-size-16.pdf__payment-type Тип платежа: <span>{{state.payment_type==='annuity'?'Аннуитетный':'Дифференцированный'}}</span>
        //Данные о погашении
        .pdf__section.pdf__padding-16.grey-border
          p.pdf__section-title Данные о погашении
          .pdf__row-block.mt16
            .pdf__col-block-50
              p.pdf__result-label Вы закроете ипотеку
              p.pdf__font-size-16 {{repayment_information.mortgage_closure_month | capitalize}} {{repayment_information.mortgage_closure_year}} года
              p.pdf__additional-text(
                v-if="repayment_information.if_earlier_month>0"
              ) Раньше на {{repayment_information.if_earlier_month}} {{getMonthDeclension(repayment_information.if_earlier_month)}}
            .pdf__col-block-50
              p.pdf__result-label Ежемесячный платеж
              p.pdf__font-size-16(v-if = "shedule.length > 0 && array_early_repayment.length > 0 && (repayment_information.monthly_payment_min!==repayment_information.monthly_payment_max)") от {{repayment_information.monthly_payment_max | format_decimal}} до&nbsp;{{repayment_information.monthly_payment_min | format_decimal}}&nbsp;₽
              p.pdf__font-size-16(v-if = "shedule.length > 0 && array_early_repayment.length > 0 && (repayment_information.monthly_payment_min===repayment_information.monthly_payment_max)") {{repayment_information.monthly_payment_min | format_decimal}}&nbsp;₽

              p.pdf__font-size-16(v-if = "shedule.length > 0 && array_early_repayment.length === 0 && state.payment_type==='annuity'") {{repayment_information.monthly_payment_annuity | format_decimal}} ₽
              p.pdf__font-size-16(v-if = "shedule.length > 0 && array_early_repayment.length === 0 && state.payment_type==='differentiated'") от {{repayment_information.monthly_payment_max | format_decimal}} до&nbsp;{{repayment_information.monthly_payment_min | format_decimal}}&nbsp;₽
          .pdf__row-block.mt16
            .pdf__col-block-50
              p.pdf__result-label Основной долг
              p.pdf__font-size-16 {{loanAmount | format_decimal}}&nbsp;₽
            .pdf__col-block-50
              p.pdf__result-label Проценты
              p.pdf__font-size-16 {{repayment_information.percentages | format_decimal}}&nbsp;₽
          .pdf__row-block.mt16
            .pdf__col-block-50
              p.pdf__result-label Всего заплатите
              p.pdf__font-size-16 {{repayment_information.pay_in_total | format_decimal}}&nbsp;₽
            .pdf__col-block-50(v-if="array_early_repayment.length > 0")
              p.pdf__result-label Экономия
              p.pdf__font-size-16.green {{repayment_information.savings | format_decimal}} ₽


.pdf {
  &__export-content {
    //это после разрабтки расскоментировать, чтобы не виден был на странице
    //position: absolute;
    //left: -9999px;
    //top: 0;
    box-sizing: border-box;
    width: 595px;
    padding: 24px;

  }

  &__page-inner {
    width: 100%;
    max-width: 547px; // 595 - 24*2
    margin: 0 auto;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    row-gap: 16px;
  }

  &__header {
    width: 100%;
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
  }

  &__header-col-des {
    flex: 1;
    max-width: calc(100% - 120px); // оставляем место под логотип (~100px + отступ)
    font-family: $ff-semi-bold;
    font-size: 22px;
    line-height: 127%;
    color: #252628;
    p {
      font-family: inherit;
      font-size: inherit;
      line-height: inherit;
      color: inherit;
      margin: 0;
    }
  }

  &__header-col-img {
    flex-shrink: 0;
    width: 104px;
    img {
      width: 100%;
      height: auto;
      display: block;
    }
  }

  &__section {
    &.grey-border {
      border: 1px solid #c8c8cb;
      border-radius: 8px;
    }
  }

  &__section-metrika {
    display: flex;
    column-gap: 20px;
    justify-content: space-between;
    align-items: center;
    width: 100%;
  }

  &__font-size-16 {
    font-family: $ff-semi-bold;
    font-size: 16px;
    line-height: 125%;
    color: #252628;
    &.green{
      color: #699b12;
    }
  }

  &__link-new-calculation {
    font-family: $ff-semi-bold;
    font-size: 14px;
    line-height: 143%;
    color: #252628;
    @include underline-link(3px);
  }

  &__padding-16 {
    padding: 16px;
  }

  &__section-information {
    border-radius: 8px;
    background-color: #f4f4f4;
    display: flex;
    align-items: center;
    column-gap: 16px;
    font-family: $ff-medium;
    font-size: 14px;
    line-height: 143%;
    color: #252628;
    width: 100%;
    p {
      font-family: inherit;
      font-size: inherit;
      line-height: inherit;
      color: inherit;
      margin: 0;
    }
  }

  &__section-information-img {
    flex-shrink: 0;
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    width: 40px;
    height: 40px;
    background-color: #fff;
  }

  &__section-information-img-icon {
    width: 15px;
    height: 15px;
    background-position: 50%;
    background-repeat: no-repeat;
    background-size: contain;
    background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg width='15' height='15' viewBox='0 0 15 15' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3cpath fill-rule='evenodd' clip-rule='evenodd' d='M0 7.33333C0 11.3834 3.28325 14.6667 7.33333 14.6667C11.3834 14.6667 14.6667 11.3834 14.6667 7.33333C14.6667 3.28325 11.3834 0 7.33333 0C3.28325 0 0 3.28325 0 7.33333ZM13.3333 7.33335C13.3333 10.6471 10.647 13.3333 7.33333 13.3333C4.01962 13.3333 1.33333 10.6471 1.33333 7.33335C1.33333 4.01964 4.01962 1.33335 7.33333 1.33335C10.647 1.33335 13.3333 4.01964 13.3333 7.33335Z' fill='%23252628' /%3e%3cpath d='M6.66667 4.66667V7.33333C6.66667 7.70152 6.96515 8 7.33334 8C7.70153 8 8.00001 7.70152 8.00001 7.33333V4.66667C8.00001 4.29848 7.70153 4 7.33334 4C6.96515 4 6.66667 4.29848 6.66667 4.66667Z' fill='%23252628' /%3e%3cpath d='M6.86194 9.80473C7.12229 10.0651 7.5444 10.0651 7.80475 9.80473C8.0651 9.54438 8.0651 9.12226 7.80475 8.86191C7.5444 8.60156 7.12229 8.60156 6.86194 8.86191C6.60159 9.12226 6.60159 9.54438 6.86194 9.80473Z' fill='%23252628' /%3e%3c/svg%3e");
  }

  &__section-title {
    font-family: $ff-semi-bold;
    font-size: 20px;
    line-height: 120%;
    color: #252628;
    margin: 0;
  }

  &__row-block {
    display: flex;
    column-gap: 24px;
    width: 100%;
    &.mt24{
      margin-top: 24px;
    }
    &.mt16{
      margin-top: 16px;
    }

  }

  &__col-block-50 {
    flex: 1; // ← КЛЮЧЕВОЕ ИЗМЕНЕНИЕ: вместо width: 50%
    // width: 50% — УДАЛЕНО
  }

  &__input-title {
    margin-bottom: 8px;
    margin-top: 0;
  }

  &__block-with-data-radius {
    width: 100%;
    border: 1px solid #c8c8cb;
    border-radius: 20px;
    padding: 10px 20px;
    font-family: $ff-semi-bold;
    font-size: 14px;
    line-height: 143%;
    color: #252628;
    box-sizing: border-box;
    p {
      font-family: inherit;
      font-size: inherit;
      line-height: inherit;
      color: inherit;
      margin: 0;
    }
  }

  &__payment-type {
    span {
      font-family: $ff-medium;
      font-size: 14px;
      line-height: 143%;
      color: #252628;
    }
  }
  &__result-label{
    margin-bottom: 8px;
    font-family: $ff-semi-bold;
    font-size: 14px;
    line-height: 143%;
    color: #6d6d6d;
  }
  &__additional-text{
    margin-top: 2px;
    font-family: $ff-medium;
    font-size: 12px;
    line-height: 133%;
    color: #699b12;
  }
}


js----------------
// === ВСПОМОГАТЕЛЬНЫЕ ФУНКЦИИ (ваши фильтры) ===
    formatDecimal(val) {
      if (val !== undefined && val !== null) {
        return new Intl.NumberFormat("ru-RU").format(Math.abs(val.toFixed(2)));
      }
      return '';
    },
    capitalize(str) {
      if (!str) return '';
      return str.charAt(0).toUpperCase() + str.slice(1);
    },
    replacePoint(val) {
      if (val == null) return '';
      return String(val).replace('.', ',');
    },


    // === ОСНОВНОЙ МЕТОД ЭКСПОРТА ===
    exportToPDF() {
      pdfMake.fonts = {
        Roboto: {
          normal: 'Roboto-Regular.ttf',
          bold: 'Roboto-Medium.ttf',
          italics: 'Roboto-Italic.ttf',
          bolditalics: 'Roboto-MediumItalic.ttf'
        }
      };

      const logoBase64 = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATgAAABgCAYAAACJ1W5EAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAy3SURBVHgB7d1ddtrWFgfwvQW4zhsdQemKcch9ifPch+AR1B2BnREkee9awSOIMwKTEcQdQFfoCOK81BjIijKC6z4l14DO3VuAkYRA4ts6/f/WahxAPhZK+ft8i2kB+/uVY0NUn3mQoXq73XwefbpcrnwgpiqtQbvVZFqR8n7lXL6czDrGeHTY6TQb6yxjG07/pBo79Dr6vLNDpd9/oa8EkBEOzSlVuGVcmmDaRBkAsJy5Ag7htrkyAGB5qQMO4ba5MgBgNVIFHMJtc2UAwOrkkw5IDje+ka7yIi3LzBGgzEcr+ZlDycGU/B5XUQYArNbMgEsVboYPic1HWlLciOs0MhJbWtVIbGIwGXNpHH7Hht6sswwAWL2pTdS04dZu/31JGZUmmLrd/x2yZ27WWQYArEdswCHc6C6YXNedGkzM5s2yZQDA+kwEHMKN0gcT88HSZQDA2oQCDuFGqwkmhBvAvXA3yIBwo1UF07t2+/qEAGDr/Bocwo1WF26t5gkBwL2Qtz3cSqVSceeHB+fGmKOpByHcAKzk2F5zKxR2jxBuAP9OM5ZqZT/cEiHcAKw2JeAQbikh3ADusfilWsZctNtX9oYb6VvkV8tO4zCe3RsQAGTd3BteAgBkBQIOAKyFgAMAayHgAMBaCDgAsBYCDgCshYADAGsh4ADAWgg4ALAWAg4ArIWAAwBrIeAAwFoIOACwVuKd7QGyTnd19jc+JfOEiYvMpqjPe4Zccpyv7PUa7Xbb6t1z/q0QcGCtvb1KlZleE1NVH0u4+c+b4VfWL8bIX3J6zw5XXjhtt5t1AmugiQrWqVQqpXK58oEd+jAKtxRKcuy5BN2XUqlSIrACAg6sUi7/56Dv8cc5gi2qVNihL48ePX5JkHloooI1NNyIzQdpdxYnX9Vt+M2FYfrK0vdmHC4azytJM/WZNF0Pokd7xryRkKPr66szgsxCwIEVtFna97z38tdwuBlzqdvTdzpXjWnfOwjG/jlFgk5DrlwuYwAiw9BEBSt4Hr8h7UcLPmfM23b7+mmn02zM+l69uVK7df1UhhtOo685Tr5KkFmowUHmyYDCiaHwvW813D63r+fqR+u0mrWH5cdFh80LGVxtMDmvrlvbv7Oc1CKlZpnza5ee5904jnGXrVXqQEou5x04juPXeOX9ur3e98tlb8S0rnIXhYADGxxHHrvzhttIv/utxvndi2m1vr39R+/j+uzSMsxvO5F+PR3xlUGR0uhxr8vVL1+uvkof4AvPUC3Yp+jkBo2uRae16C8D0uvlD8KMG3A6Zaaws6uvNzw5x8+tq4u0Zeo8w52d3RdSAz4hvxYdU+5+pd69pVPXbbqx5yWj13cPJBTlfR3O+pmDLgkjXRI8mNNI/CrunBFwkGmD/9EjI6ZmsqmZ1rCm0Zj2Ohv5QHG4KTwXEzMA4kh5ZlxmPt/7UYKmLrXQ6oySRtNaXktwHE4LjhH/OvXpPHF0WV53yFQHgfQ98daag/5L772hxGtyIqPTJ/v7lVqr1TyNfT/jc5hJA1X+zWUwicffE3ddCX1wkHHdrhepTfFN9ifrOslBNKbTWj7Mmrs3/CUwz5xAdVIo/PBBw2TaAeNR6/SBL0FYk/A+pyUUCg9ep/2ZqMFBpnHOCQWckVFT2ix39svahDJFmgePm8D6fiQU/nKIL3VqCxujrz2j8Ae8VCiY9xJGh9Ea1124TQTCeNrM8PETjvRj6nkUCrs6Mj3RXBw2EWOm5ETKNfSMo8HKdCLN70+LTMGRGuBr6W9N3f2AgINM48gHlxMDZ7VG/WXTXvf7vKQpSQuQ/rpXMvAxEQJaq8oVHtR0MOTuSQmj/M6ufvBrwWMl3CZqOzoA0+9+r8WFoY5GhwZsJJz0PURrxYNR63C46Sh07/bbWZqQ7Zs5Q188fLh/ZCLvLwmaqGCVcY0k2/xwm1LD0QD53L566Rl+G3xeBj9eBJuUGiw06PgflyshpAMwcX1rzWbTbbWufpNywp31zC+CD3VUNzpqPQzj2rRypT/vqZ66jk4bjw71WJqDvhcZYHlDc4qvwTEfSSdjlTYoNIqSyK/2E0AUG/qJsq/eSdF80xFfZ+fB8bgmZYr5/K42YRv+631pGoY77N00wXJ7++15YedBNVDugW5cMBpZ9ih/4oQ/f4nnq8En4ft0keki40GFYE1UmsIpmv5Tmqj+N85dhVxSKf2hCDcYkFrMjTTV7h4zmx8p4zziP9Icp2HxsPz4ncM0rmE5fn9XQ/9q2PzKwYRLObqs5UqFQ89hPP0mx3fBKeH2hBY8X1rAzg8PzqUvshQsyjPeH06kZhkHTVTINPmwhQYVDDnPKOMc03NTHxt5/8EarD+lJUAn3VJK0uQMD9YE+8ycSJ9elz7SmviDCibUHHZ1WgwzpwpLBBxkWi4XnbNmitqcogzr9fL/pTXo9zl1NxB7JhQgZoFBgWUNVqiEBxWk/+550py/IAQcZJp2YEu1rRF8zt/kcgnb3g9OJ/qmPVanjgQfe2T+uXuNwyHlFOgppS03Mpk5VGMy4XLnOd+0/AES5tCggg6QJK0rjtI+OJfWYnyhQwajXC5tiL92L+e4tIT7UgZM9U7+q949Yqpq02bKjPmZBsujzFnS0qJ1MpzTJlmq+XxS0/o12M2m8+XuyjHOVw70T0r1pyp/XlCacknKDRRsKNhk5U/yx8Ei55sOF6Nz7IZri2s0p3y71fyZNkh+3glt0OfPLf0HTfWPet/LgHg6R0uXLFFgoEqbNhJyNE/IyfHHGm7Dh7q0qDpcWvSONmg43eMsqVM+bplatzuuzbIxFxQYgHDYOZba6VlSaA/Xqx4En+vffmvcPdAaM48HIAbnW6knlev/8vDMP8krTSYGORdeW4wmKtjBOL9NPKXLgvYr50lNTp2GUC4/fiPH16MvGZO0MnIdTDFpmVRg8uz4uyR4giEzbM65oXITlnX5/ZeRpqGoB8O22/1+MZimETxfXUkxvVytUfu/PObfFt4fVKAFYSUDWEH3dNvbe/SKnYkPp7/IW3fJkP6qP6g/HnXkQT/TM533GTenyu/z2da6Vl0mtbP7Uc77VANlFDCjnTv6Hr+MnnOvS8+jxWinvH9vijF/7aqWK/Wyy9G2S4Mb9LA0d3UZVGgalgZMqBas5yLX+jR0rf3zDZer56rz8rRP1FCopumfg3xNbj3KLy7X/dulBSHgwBqdzvXZ3n6lKFWuyUEG6Zdj3Z0jts1i4p45nXe2/Rr4O4ZI0Emt5/GwxmSKg7MNn7Oeb1wTUWtxck1OI9ekNFg+5t9NLFxKhNf3Xrluy50s91r7KbUZe5xcbhTfdG9NYq1ssDpiuf340EQFq2go6VIgWnggi29Gy45oS+T8azHPTl20nxTG/jWhebeQ0kXz9HzYdxxL+9Ojy8XSlcuJ2zv572kF98PIS7rXCLamd0v1bYzU2WzY9/Tz3qPHL6XWpp3speTvkmAj8zZusfim9ftcd0z/03DtZWn6kXzj9fszQ2hEQ06ajy7x5OL7KO3L63VNqvlmuiZWyr2cr9wrl2YfeNlZYMQ0Tj62Og8bk8/7o14uwcoNawBnfse5LmEy/jZDo743f+qDMd5XnVrR7X67SBNs8iHV5t678eNv/8w6Xici9/vjvjEmJ1WTazTq7k921b4xY4p63hLCN2z8KRt/pT3nkeHoZV135ZAh1SrrFkmRayFlX8w712xU7nDnlKpco5+C5cqfn9j0Lzqztlk342vU7XKDErBx5Pp47uhxvxu/SSlLWxkLO7fI31lhzv+h1u30T6pJx/TELz5nh0q//2LHbh33SflR5UtwR99el0uztmCC9NAHBwDWQsABgLUQcABgrXz3NsVkO1ij71sdsQOwWR5TFADAVljJALBl/p3ADLvjx7OnnkB6CDiALeu0rn8jWAsMMgCAtfL3eXtn5v5NO2b2s261ks/Pc5Oa+6vX+3657aVBALbKR7ZSuV9Mri5/TmwBU9jxFyMfkwXy+V1dGN4gAFg5NFEBwFoIOACwFgIOAKyFgAMAa8XPg2P6i7yJG3Csl7/V8ZLM5IDESs5jFdeD/T3prRgYAciK+IDz6Et7wzfb0Lsf0ZJWcc6x57GC61EuVyh4qzUAWD80UQHAWgg4ALAWAg4ArIWAAwBrIeAAwFoIOACwFgIOAKyFgAMAayHgAMBasSsZmE3xPm+EOc26znkV18OQecLEBACbExtwhviIHTqijFnX5p2ruR4IN4BNQxMVAKyFgAMAayHgAMBaCDgAsNb92fAyhsmRG/u8nBvzmu5Eta4NL6fo9eLfIwAs795seDmPTqfZoDVZ14aXALB5aKICgLUQcABgLQQcAFgLAQcA1vo/4J9wkUX74FUAAAAASUVORK5CYII='; // ваш логотип
      const iconBase64 = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAB4CAYAAAA5ZDbSAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAoXSURBVHgB7Z2/dxvFFsevc15rxbTPLjad/ZqE8w5yGfuRVydKDYlcPmJDUr33oAgpCKGC4IQWKdBiJ7QYrJQ2RUyD3Vmck9Q40h8g7nd31hmNdy3tamd1R57POWP5pyTrq3vvzL13ZqdoAuj1ejN8c4lHwOMijxn1eaB+ZUYNkzaPI238pm73MKampo7IcabIQVjQJYoEvUxvhLVBmyKxn1MkeIscwwmBlYXWeVylSNAZGg+w6BaPZ7hlwdskHLECG6IukUxaPJokWGxxAiv3e5PHNRqfpeahwaPpohsvBQjLY7vnPi941MkT0YuEPexNHoc9AUKPzUX3Ild8l+TG16Jo81gZl+suXWAWNuCbb2nyhTVp8LhX9mTsHJUIi/sR37ygsycuqPNAfL5LJVKKBZ9hq02jzWO5DGu2bsFn3GrTCCiy5ttkGWsW3IsSFXBH1v8Jx/mKLfkOWcKKwMolb1KUVvQMpk2WXHbhArO4EBXiBuTJQpssiFxoDGZxkV7cJi9uHgKK4vI1KpDCLJifGPLHDfIUQZ0tuUkFUIjAXlwrFCLyyAJ7ca0yssgjCazixSZ5bFJjkZ9STnILrJZCSGC4VLN1EXSRYHa9RznINYtW4mK27MW1D17jTfWaZyazBasMFSw3IE+ZwIKXs3Z65rFgpB8D8pQNEkiZK1GZBFaFA59bHh+3sxYohnbRflIlBrjot4dNaWaxYD+pkgE0+HbYXx5KYNWFEJBHCkvDuuqBLtq7ZrEM5aqHsWBYrxdXHkO56lMtWLW2bpNHMsunteQOEviQfOyVDvZFLaf9MNVFq678gDzSWVKeNpFUC/bW6xRttuILST9ItGBvvc4RpFlxogXzL2NZ5Dsi3SIxFp+w4N6b4xE8bpEYi5Nc9E3yuMoJ7fpctMpaHZLjdLtd2tnZpZ3dXXr16hXt7x9Qp9uhbqcb/ny6Mk1zs7M0PV2hhYV5WqxWaXGxyl9Pk+Mgu3VBrxmbAtcpQyJbGhB1/dFj2j/YPxYzC1euvEvXa7Xw1mHusMBfxV+YAiNrtUSOsbX1M312//PQWotglq17bfUWXb9eIwfpm2wdC+yie4ag//3fx7TLrtgGcN/fPH4UCu4Yb8VuWhe4Tg6550bzCbvjR6mueG727+xqr9A8i1TlGHu+UjmOsYjRL1++Ct8geHP8xB4gzforHK/XVlfp5s0b5BDHbloXGP3Nhe6LscX6+uNQ3CSu165RjV0rJk5ZwESs2WzSxmZyCzJEXlu7RY5w7KZ1gf8kB8qCaeIuVt+hBw8+H9mdwpLX1x8lCu2QyEcs8Fv4JBTYlbJgkrhY8nxowYWmhQCHRA7LiHGiQ3zmKn7BdWCt3z95YiU+1vk+f3y6ecIj4Dk0+bk4QKhpLPBlEkzoNpPE/a4ZznRtET9GkshFLckssoQPTljwf26t9rlKuOWkF94GeAwslfCYMR1+LlieCQfnZtM5tRUlIKFsbGzSAc9wdRBzy1ybwksg9upgeYUEi2BQQpyBBYu2XqQedbAMyhNzNzae0j/fqdLyv67wDDn7jlfE5Kqx9EL2TDiXRAu8lZCAWFtbpTzEM2Lc3/2cwnzx4H7f17ivHUtZtIIIILDYte8PxloU1pvXNetvlE6OQgTAY+M56GDpJpjQgi+SQCDCz1tbfd+r18dfqq4ZBYgDVK66+d4wJXBerAWbBQRYz/y8vSXRsCAFqnsRvBF3dnZIKHJdtBnb/i2oRmvWi3d3fyWhyBV431gaVTnXLIUFw5NITnpA4IAEghYbnbm5OZIC2nt0fjfejIKYKfVA8CyYViGp6I5eLp2u8WYUhFyBzSqOpIa4SqX/ueRddpWBWIGLRs8lO9iCkxuxAk8bVjLqWvOTj/8fCov7HbWea1qsadGS+BtFvbTiZtIVjnO6m+50OiO5abTDYhSB5PmBCSw408FaZTG/sND3NXqepWAKXJHbMN8W66LRFalzcDDaUmTUapKOmYRZMN6MgjiCwG0SiNkV+dOItdciqkkxZh1YUhLGIBT4DxIIaq/6RGvU0pyeODHXsVlAhs100YuLiySU12JjMGamC/P9rg9uNi9FzaIbRsMdcuSCN63tTUne0QCLff/9/hLh9i9bY5u1wnIRw3W+ebwe7qAQyh2xMRiYpTkwzma3r43iPp6bYHHBHgTeI8HAteqgTjyOvmS45k1j9u1AA/zeObULrU1CQe3VbHbDjHj/oLwKTlJfNjoti0qcWAIn7xzF62DRVoxmN7Mv+YMPVkupw+Ix3uN5gNmXjV5p4fyGD7HAz0kw0Ybs/m7K+IW3KTKWREmPUXZfdk5a+OCEBQP0JZsxDy/81Ws1KzEZMfe9GzcS2nZvubJXONTUve2jHAuTWlVrHA8/5Be/iO2jaacGQFzTkwilf/socOl8jjSRAYSGtWfdlIZiBvYEb6bkqR0SFzxjgcMGbl1gnCD+JTnCoCMcojXqu8dr6bm52b4jHF6/7oRWitn41ilHONjaf2yZFRa4gU90geGe/ySHgCjYeXhgqemtqFMDxsCF+CT4iThGCeU/uOwij1FCgsXR87KSj1ECrrlpE7haiJ1nWydc8T/m52l1bTXzAS7COHbPwBQYbhpnZTl9jYb4KMMwxu7vc6mwSy/ZuvWjDM9zPEbXCI40rE7OUYbggn6hjhPHCbPIDfIHkrpKg8Vd0b+R1LLTII+rnLiYdNqB4E5Ots44e2y9b5vfTGu6u0ce13iY9E1/UY7JINtFORQr5HGFVI876MJYPhbLJ9V6waDGdx+L5XOqpz1VYHVNvBZ5pNI47bqFwF9e1l2KubysugPvquXxcJjLvA+04Bg/4RLFqRMrnSy7CxHMRW5zOWNAg+Vhf3logb2rFsO9YVxzzNAuOoZdNa7m8RF5xgHi7u0sf5BHYMymEY/9BSzLpU3RrDlTmMy8w189QI0Eb3eZQNoUXWQj8xwoswXHsCXDgmHJfn1sl6HWu2nkPqODHxCd874gYZ+VvOKCkQ5h4QfGlnsvsj1W1Gucm9wuWsf1y9IKpa87Mi+FCAy8yIVSiLigMIEBi4z9MBDZT7zygQnVyG5Zp1CBgao+YXYdkCcLbR41NXktjMIFBl7kzEDU2iiz5TSsHGWonihaOB+SZxB4jZZtiAusWLCO2u90l3xcNkG8vRdfqdsW1gUG3mWfoEUjJjCGpZTTZvGPqAI1yo1nuaaM//0OtneWIS4oxYJ1lDV/Smdvg1uLSrJandIFjlGXlceaOaDJpkVRrG3RWQQZMGyT6U0eh73oTewBvUjoFz332e4JEnZsLjoN9eLUya0YjckT0otNaa5YnMAxvWgytkSR0EskkxaPZxTtMBC5OhArsI4m9lV1O66kCUREWlG0qDpOCGyi3Dhahi6r24Ds0KZI0OcU7aBvkWM4KbBJL+r0vKQGPr+obuMRJPzZEb1JurTVeE2RoPh8zwULHcRf0A1q1OL7lvMAAAAASUVORK5CYII='; // иконка 40x40

      const docDefinition = {
        pageSize: 'A4',
        pageMargins: [40, 80, 40, 40],

        header: (currentPage) => {
          if (currentPage === 1) {
            return {
              columns: [
                {
                  stack: [
                    { text: 'Калькулятор', style: 'headerTitle' },
                    {
                      text: 'досрочного погашения',
                      background: '#daff01',
                      style: 'headerTitleHighlighted'
                    },
                    { text: 'ипотеки', style: 'headerTitle' }
                  ]
                },
                {
                  image: 'logo',
                  width: 104,
                  alignment: 'right'
                }
              ],
              margin: [40, 20, 40, 16]
            };
          }
          return {};
        },

        content: [
          {
            columns: [
              {
                text: `Расчет платежей от ${this.currentDate}`,
                style: 'metaText',
                width: '*'
              },
              {
                text: 'Сделать новый расчет',
                link: 'https://xn--h1alcedd.xn--d1aqf.xn--p1ai/calculators/kalkulyator-dosrochnogo-pogasheniya-ipoteki/',
                style: 'link',
                width: 'auto',
                alignment: 'right'
              }
            ],
            margin: [0, 0, 0, 16]
          },

          {
            stack: [
              {
                columns: [
                  {
                    width: 'auto',
                    stack: [{ image: 'icon', width: 40, height: 40 }],
                    margin: [0, 0, 16, 0]
                  },
                  {
                    width: '*',
                    stack: [{
                      text: 'Расчет носит справочный характер и не может быть основанием для совершения юридически значимых действий',
                      style: 'infoText'
                    }]
                  }
                ],
                margin: [0, 8, 0, 8]
              }
            ],
            style: 'infoBlock'
          },

          {
            stack: [
              { text: 'Данные об ипотеке', style: 'sectionTitle' },
              this.createMortgageBlock()
            ],
            style: 'sectionBox',
            margin: [0, 0, 0, 16]
          },

          {
            stack: [
              { text: 'Данные о погашении', style: 'sectionTitle' },
              this.createRepaymentBlock()
            ],
            style: 'sectionBox'
          }
        ],

        images: {
          logo: logoBase64,
          icon: iconBase64
        },

        styles: {
          headerTitle: { fontSize: 16, bold: true, color: '#252628' },
          headerTitleHighlighted: { fontSize: 16, bold: true, color: '#252628' },
          metaText: { fontSize: 12, color: '#252628' },
          link: { fontSize: 12, color: '#252628', decoration: 'underline' },
          infoBlock: { background: '#f4f4f4', padding: [16, 16, 16, 16] },
          infoText: { fontSize: 12, color: '#252628' },
          sectionTitle: { fontSize: 16, bold: true, color: '#252628', margin: [0, 0, 0, 16] },
          sectionBox: {
            border: [true, true, true, true],
            borderColor: ['#c8c8cb', '#c8c8cb', '#c8c8cb', '#c8c8cb'],
            padding: [16, 16, 16, 16]
          },
          label: { fontSize: 12, bold: true, color: '#6d6d6d', margin: [0, 0, 0, 4] },

          // Стили для "Данные об ипотеке" (24px между рядами)
          mortgageValue: { fontSize: 12, color: '#252628' },

          // Стили для "Данные о погашении" (16px между рядами)
          repaymentValue: { fontSize: 12, color: '#252628', margin: [0, 0, 0, 0] },
          repaymentValueGreen: { fontSize: 12, color: '#699b12', margin: [0, 0, 0, 0] },

          valueInline: { fontSize: 12, color: '#252628' },
          valueNoMargin: { fontSize: 12, color: '#252628', margin: [0, 0, 0, 2] }
        },

        defaultStyle: {
          font: 'Roboto',
          fontSize: 10
        }
      };

      pdfMake.createPdf(docDefinition).download('расчёт-ипотеки.pdf');
    },
    createMortgageBlock() {
      return {
        stack: [
          // Строка 1: Сумма кредита + Дата получения
          {
            columns: [
              {
                width: '*',
                stack: [
                  { text: 'Сумма кредита, ₽', style: 'label' },
                  { text: this.$options.filters.format_decimal(this.loanAmount), style: 'mortgageValue' }
                ]
              },
              {
                width: '*',
                stack: [
                  { text: 'Дата получения', style: 'label' },
                  {
                    text: `${this.$options.filters.capitalize(this.obj_month[this.startMonth - 1])} ${this.startYear}`,
                    style: 'mortgageValue'
                  }
                ]
              }
            ],
            columnGap: 24,
            margin: [0, 0, 0, 24] // ← 24px после строки
          },

          // Строка 2: Ставка + Срок кредита
          {
            columns: [
              {
                width: '*',
                stack: [
                  { text: 'Ставка, %', style: 'label' },
                  { text: this.$options.filters.replace_point(this.annualInterestRate), style: 'mortgageValue' }
                ]
              },
              {
                width: '*',
                stack: [
                  { text: 'Срок кредита', style: 'label' },
                  { text: this.formattedTerm, style: 'mortgageValue' }
                ]
              }
            ],
            columnGap: 24,
            margin: [0, 0, 0, 24] // ← 24px после строки
          },

          // Строка 3: Тип платежа (без отступа снизу)
          {
            columns: [
              {
                width: '*',
                stack: [
                  {
                    text: [
                      { text: 'Тип платежа: ', style: 'label' },
                      {
                        text: this.state.payment_type === 'annuity' ? 'Аннуитетный' : 'Дифференцированный',
                        style: 'valueInline'
                      }
                    ]
                  }
                ]
              }
            ],
            columnGap: 24
            // без margin
          }
        ]
      };
    },
    createRepaymentBlock() {
      const ri = this.repayment_information;
      const hasEarly = this.array_early_repayment.length > 0;
      const isAnnuity = this.state.payment_type === 'annuity';

      let paymentText = '';
      if (hasEarly) {
        if (ri.monthly_payment_min === ri.monthly_payment_max) {
          paymentText = `${this.$options.filters.format_decimal(ri.monthly_payment_min)} ₽`;
        } else {
          paymentText = `от ${this.$options.filters.format_decimal(ri.monthly_payment_max)} до ${this.$options.filters.format_decimal(ri.monthly_payment_min)} ₽`;
        }
      } else {
        if (isAnnuity) {
          paymentText = `${this.$options.filters.format_decimal(ri.monthly_payment_annuity)} ₽`;
        } else {
          paymentText = `от ${this.$options.filters.format_decimal(ri.monthly_payment_max)} до ${this.$options.filters.format_decimal(ri.monthly_payment_min)} ₽`;
        }
      }

      // РЯД 1
      const leftStackRow1 = [
        { text: 'Вы закроете ипотеку', style: 'label' },
        {
          text: `${this.$options.filters.capitalize(ri.mortgage_closure_month)} ${ri.mortgage_closure_year} года`,
          style: ri.if_earlier_month > 0 ? 'valueNoMargin' : 'repaymentValue'
        }
      ];
      if (ri.if_earlier_month > 0) {
        leftStackRow1.push({
          text: `Раньше на ${ri.if_earlier_month} ${this.getMonthDeclension(ri.if_earlier_month)}`,
          style: 'repaymentValueGreen'
        });
      }

      const row1 = {
        columns: [
          { width: '*', stack: leftStackRow1 },
          {
            width: '*',
            stack: [
              { text: 'Ежемесячный платеж', style: 'label' },
              { text: paymentText, style: 'repaymentValue' }
            ]
          }
        ],
        columnGap: 24,
        margin: [0, 0, 0, 16]
      };

      // РЯД 2
      const row2 = {
        columns: [
          {
            width: '*',
            stack: [
              { text: 'Основной долг', style: 'label' },
              { text: `${this.$options.filters.format_decimal(this.loanAmount)} ₽`, style: 'repaymentValue' }
            ]
          },
          {
            width: '*',
            stack: [
              { text: 'Проценты', style: 'label' },
              { text: `${this.$options.filters.format_decimal(ri.percentages)} ₽`, style: 'repaymentValue' }
            ]
          }
        ],
        columnGap: 24,
        margin: [0, 0, 0, 16]
      };

      // РЯД 3
      const row3Columns = [
        {
          width: '*',
          stack: [
            { text: 'Всего заплатите', style: 'label' },
            { text: `${this.$options.filters.format_decimal(ri.pay_in_total)} ₽`, style: 'repaymentValue' }
          ]
        }
      ];
      if (hasEarly) {
        row3Columns.push({
          width: '*',
          stack: [
            { text: 'Экономия', style: 'label' },
            { text: `${this.$options.filters.format_decimal(ri.savings)} ₽`, style: 'repaymentValueGreen' }
          ]
        });
      }

      const row3 = {
        columns: row3Columns,
        columnGap: 24
      };

      return { stack: [row1, row2, row3] };
    },
