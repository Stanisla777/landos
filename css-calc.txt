exportToPDF() {
  pdfMake.fonts = {
    Roboto: {
      normal: 'Roboto-Regular.ttf',
      bold: 'Roboto-Medium.ttf',
      italics: 'Roboto-Italic.ttf',
      bolditalics: 'Roboto-MediumItalic.ttf'
    }
  };

  const logoBase64 = 'image/png;base64,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';

  const iconSymbolBase64 = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAYAAAA6GuKaAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAVFSURBVHgBzVk/UxtXEN99d/LgmZARCHvocowRiDTInTtElxI+gXGZClylRHyC4DKVlS5d8CdArlIGmiADwecumQh8nbHu9F52T3/83ukQujsJ85uB0737t7f3e/t2f4uQEYuLpQpYWEapVgFUGRDzNOxop7igwEVUnkTxFmVQPzs7O4IMQEiBUqnkSAnPFeAOGZqH5HCVUgeBj69ct+FCQiQymo1tt+E1XVWB8aHmt2AvifEjGe04Tj6Xe7gLqHZgQiBDqqenjb0Rzx2O0LsSDsHkqQGloK5AHYNUdSFs1/el1ztm2+AoJfMgsIKAqzj8K7nk9fXbvD7U6KWlEvN2P5636JGhr4LW9b7ruh6MiC7FKvTkXYh3BE3c9uawyYrDDYYaxBmLsHf+7mQfMmJxqVQl72/HOYUM2yK6/Bp3XazRT54sbQhL/B4dZxoE/vVmEs/ehg79FD0Ly+YR9EAF63Eex/ib4J/Rtyev752fNqowIXS8HlJGN8/zW+pplOOWvsNRAoX9B/2c18cnbTDj6rJZny3M0Tw1JuqUJaB8ddU0aGIY/fjx/E+02dDH7sLgHtjwmdlHM2T5s/4ggsMvw8e+DHXRDW3v9Zsg4sHpu5NNuGMUi6VDcwFjmnxa6M0l0RsmgyN8Arf1Wb2EFKDIs8sPXl5e2YYUsCx4EU7EPlTefjDVX9hCerCXKTLUjCsVvLy4aNQhIcjYLfLSPn9WotYPM4VHxx8vm40k92g2mx5R4qHObwqN5W+nv/nF87zr0NNxXj47a9QgDSIrHnLmlwK8aN3k7R49KsYVCkbKASYJ5i+vuPoYKljjrSgWi+wJRz/o+1CHewBbRChLX3FhYeU7oYRd0cd51UuT404CjQbZgZSLaBC2Wheg5JpxJsJbuEeQEt+YI6osMEINyuoylULjBnnVsMeiqEQTUTjGSSpw4R5BSmkkZ+TUVRFNjILA/gj3CEIod2AM7jksyxpIg8dutJJmmApacYXE6AiCwepGREOKbQczkAHn57T0q/ZTzg7pBdbHHz7Rsykwe3otIMHixSZTBOlWG+OJQiQE8eLRA+klZDTgMf3W8oN0uYKOUHUSUGFqZPU0KlauvoCrfqHQjMvEl1XIgGLx+zIKOOTSKfcA3nfThCyoGHso6oK1NXMQKlx2QUpIUFv6vkJrA1IiLi9qt9SRCPkXnYxawp0U0RUs0wqLllFE9PIi0d0xCkfWItJ6O8zDFVUeVFTIttz8+/TkAFKACxOAaG7esdPmf5xw5x5MaYVAP+GuQgp0C4gaZACrsnBDyhx6ulswxni75MBXQFj+DTqsH4n6KyLpC9VoeZPLkax7x2BadgVPHSxM9qupvtGccEfLG44kxeWVn+EOQTTl5zn6GIVlQ3w3xBoWRAqFAoUo1BWmZ3OFObi8bE68OGDpgTZG5OKIQWLRj/rYQMJkCdw0aRKqTNXuDScCpkRxqfQ6hsdu4LMGYiJWNeVVjdbPwxgJdiTROwnCZ0GbWiKDqmmc+Miw4m50dfXfP4XZuX/pRhXandIO5Un92WG6TE/PffC8ZmrJl70baoeofqPnzEcNJiKvX1ycxIo8QzsBHY9L1qmdmMMu/dWTNnk4mRIC1oZ0xqgTIKgT8FfyTkAPo/RcaLZQKoBHNMuPod1Zxil5d3O5dp6qaQdtywn7jB31ybn5Nizaw4tMPRcd8aL3uJCsJZK8jyjDGf4cxoJ0zabUHVvuUClU2zjQK7kdTANq0b0JPn+qpenfpDJaB78A9Q3LvT4hRYM8bSP9GuK7kh+owDjy/euDrI2m/wGRgm3+D9mZIQAAAABJRU5ErkJggg==';

  const docDefinition = {
    pageSize: 'A4',
    pageMargins: [40, 80, 40, 40],

    header: (currentPage) => {
      if (currentPage === 1) {
        return {
          columns: [
            {
              stack: [
                { text: 'Калькулятор', style: 'headerTitle' },
                {
                  text: 'досрочного погашения',
                  background: '#daff01',
                  style: 'headerTitleHighlighted'
                },
                { text: 'ипотеки', style: 'headerTitle' }
              ]
            },
            {
              image: 'logo',
              width: 104,
              alignment: 'right'
            }
          ],
          margin: [40, -40, 40, 16] // ← отрицательный отступ сверху
        };
      }
      return {}; // ← пустой header для остальных страниц
    },

    content: [
      {
        columns: [
          {
            text: `Расчет платежей от ${this.currentDate}`,
            style: 'metaText',
            width: '*'
          },
          {
            text: 'Сделать новый расчет',
            link: 'https://xn--h1alcedd.xn--d1aqf.xn--p1ai/calculators/kalkulyator-dosrochnogo-pogasheniya-ipoteki/',
            style: 'link',
            width: 'auto',
            alignment: 'right'
          }
        ],
        margin: [0, 0, 0, 16]
      },

      this.createInfoBlock('Расчет носит справочный характер и не может быть основанием для совершения юридически значимых действий'),

      this.createSectionBox(this.createMortgageSection(), 290),
      this.createSectionBox(this.createRepaymentSection(), 275),
      (this.holidays_term && this.holidays_term !== 0)
        ? this.createSectionBox(this.createHolidaysSection(), 160)
        : {},

      // ===== ГРАФИК ПЛАТЕЖЕЙ =====
      {
        stack: [
          { 
            text: 'График платежей', 
            style: 'sheduleTitle',
            pageBreak: (this.holidays_term && this.holidays_term !== 0) ? 'before' : ''
          },
          this.createSheduleBlocks()
        ],
        margin: [0, 0, 0, 16]
      }
    ],

    images: {
      logo: logoBase64,
      iconSymbol: iconSymbolBase64
    },

    styles: {
      headerTitle: { fontSize: 16, bold: true, color: '#252628' },
      headerTitleHighlighted: { fontSize: 16, bold: true, color: '#252628' },
      metaText: { fontSize: 12, color: '#252628' },
      link: { fontSize: 12, color: '#252628', decoration: 'underline' },
      infoText: { fontSize: 12, color: '#252628' },
      sectionTitle: { fontSize: 16, bold: true, color: '#252628', margin: [0, 0, 0, 16] },
      label: { fontSize: 12, bold: true, color: '#6d6d6d', margin: [0, 0, 0, 4] },
      mortgageValue: { fontSize: 12, color: '#252628' },
      repaymentValue: { fontSize: 12, color: '#252628', margin: [0, 0, 0, 0] },
      repaymentValueGreen: { fontSize: 12, color: '#699b12', margin: [0, 0, 0, 0] },
      valueInline: { fontSize: 12, color: '#252628' },
      valueNoMargin: { fontSize: 12, color: '#252628', margin: [0, 0, 0, 2] },

      // Стили для графика платежей
      sheduleTitle: {
        fontSize: 16,
        bold: true,
        color: '#252628',
        margin: [0, 0, 0, 16]
      },
      sheduleItemLabel: {
        fontSize: 10,
        color: '#6d6d6d',
        margin: [0, 0, 0, 2]
      },
      sheduleItemValue: {
        fontSize: 11,
        color: '#252628'
      },
      holidayBadge: {
        fontSize: 10,
        color: '#fff',
        background: '#252628',
        padding: [2, 8, 2, 8],
        margin: [0, 0, 12, 0]
      },
      holidayValue: {
        fontSize: 11,
        color: '#252628',
        margin: [0, 0, 0, 0]
      }
    },

    defaultStyle: {
      font: 'Roboto',
      fontSize: 10
    }
  };

  pdfMake.createPdf(docDefinition).download('расчёт-ипотеки.pdf');
},

-------------------------------------------------


createSheduleBlocks() {
  const blocks = [];

  this.shedule.forEach(item => {
    if (item.isHoliday) {
      blocks.push({
        table: {
          body: [[
            {
              stack: [
                { text: 'Ипотечные каникулы', style: 'holidayBadge' },
                {
                  columns: [
                    {
                      width: 120,
                      stack: [
                        {
                          text: `${this.$options.filters.capitalize(item.nameMonth)} ${item.year}`,
                          style: 'sheduleItemValue'
                        }
                      ]
                    },
                    {
                      width: '*',
                      stack: [
                        { text: '0', style: 'holidayValue' }
                      ]
                    }
                  ],
                  margin: [0, 0, 0, 12]
                }
              ]
            }
          ]],
          widths: ['*'],
          layout: {
            fillColor: () => '#f4f4f4',
            hLineWidth: () => 0,
            vLineWidth: () => 0,
            paddingTop: () => 12,
            paddingBottom: () => 12
          }
        },
        unbreakable: true,
        margin: [0, 0, 0, 12]
      });
    } else {
      blocks.push({
        stack: [
          {
            text: `${this.$options.filters.capitalize(item.nameMonth)} ${item.year}`,
            style: 'sheduleItemValue',
            margin: [0, 0, 0, 12]
          },
          {
            columns: [
              {
                width: 120,
                stack: [
                  { text: 'Задолженность', style: 'sheduleItemLabel' },
                  { text: `${this.$options.filters.format_decimal(item.remainingBalance)} ₽`, style: 'sheduleItemValue' }
                ]
              },
              {
                width: '*',
                stack: [
                  { text: 'Сумма платежа', style: 'sheduleItemLabel' },
                  { text: `${this.$options.filters.format_decimal(item.payment)} ₽`, style: 'sheduleItemValue' }
                ]
              }
            ],
            margin: [0, 0, 0, 8]
          },
          {
            columns: [
              {
                width: 120,
                stack: [
                  { text: 'Погашение процентов', style: 'sheduleItemLabel' },
                  { text: `${this.$options.filters.format_decimal(item.interest)} ₽`, style: 'sheduleItemValue' }
                ]
              },
              {
                width: '*',
                stack: [
                  { text: 'Погашение основного долга', style: 'sheduleItemLabel' },
                  { text: `${this.$options.filters.format_decimal(item.principal)} ₽`, style: 'sheduleItemValue' }
                ]
              }
            ]
          }
        ],
        unbreakable: true,
        margin: [0, 0, 0, 12],
        border: [false, false, false, true],
        borderColor: [null, null, null, '#f4f4f4']
      });
    }
  });

  return {
    stack: blocks,
    margin: [16, 0, 0, 0] // ← левый отступ как padding-left: 16px
  };
},
