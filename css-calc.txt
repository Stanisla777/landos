npx webpack --config webpack.css.js --watch --mode development

npx webpack-dev-server --mode development --hot --config webpack.config.js

npm warn idealTree Removing dependencies.sass in favor of devDependencies.sass
npm notice
npm notice New major version of npm available! 10.7.0 -> 11.6.3
npm notice Changelog: https://github.com/npm/cli/releases/tag/v11.6.3
npm notice To update run: npm install -g npm@11.6.3
npm notice
npm error code E404
npm error 404 Not Found - GET https://nexus.ahml.ru/repository/npm-repo/@popeindustries%2fvite-plugin-pug - Not found
npm error 404
npm error 404  '@popeindustries/vite-plugin-pug@*' is not in this registry.
npm error 404
npm error 404 Note that you can also install from a
npm error 404 tarball, folder, http url, or git url.

failed to load config from C:\Users\sshchegolev\PhpstormProjects\sprosi.dom.rf\vite.config.js
error when starting dev server:
Error [ERR_REQUIRE_ESM]: require() of ES Module C:\Users\sshchegolev\PhpstormProjects\sprosi.dom.rf\node_modules\vite\dist\node\index.js from C:\Users\sshchegolev\PhpstormProjects\sprosi.dom.rf\vite.config.js not supported.
Instead change the require of index.js in C:\Users\sshchegolev\PhpstormProjects\sprosi.dom.rf\vite.config.js to a dynamic import() which is available in all CommonJS modules.
    at _require.extensions.<computed> [as .js] (file:///C:/Users/sshchegolev/PhpstormProjects/sprosi.dom.rf/node_modules/vite/dist/node/chunks/config.js:36561:9)
    at Object.<anonymous> (C:\Users\sshchegolev\PhpstormProjects\sprosi.dom.rf\vite.config.js:35:19)
    at _require.extensions.<computed> [as .js] (file:///C:/Users/sshchegolev/PhpstormProjects/sprosi.dom.rf/node_modules/vite/dist/node/chunks/config.js:36560:44)
    at loadConfigFromBundledFile (file:///C:/Users/sshchegolev/PhpstormProjects/sprosi.dom.rf/node_modules/vite/dist/node/chunks/config.js:36564:15)
    at async bundleAndLoadConfigFile (file:///C:/Users/sshchegolev/PhpstormProjects/sprosi.dom.rf/node_modules/vite/dist/node/chunks/config.js:36444:17)
    at async loadConfigFromFile (file:///C:/Users/sshchegolev/PhpstormProjects/sprosi.dom.rf/node_modules/vite/dist/node/chunks/config.js:36411:42)
    at async resolveConfig (file:///C:/Users/sshchegolev/PhpstormProjects/sprosi.dom.rf/node_modules/vite/dist/node/chunks/config.js:36060:22)
    at async _createServer (file:///C:/Users/sshchegolev/PhpstormProjects/sprosi.dom.rf/node_modules/vite/dist/node/chunks/config.js:26008:67)
    at async CAC.<anonymous> (file:///C:/Users/sshchegolev/PhpstormProjects/sprosi.dom.rf/node_modules/vite/dist/node/cli.js:572:18)
npm notice
npm notice New major version of npm available! 10.7.0 -> 11.6.3
npm notice Changelog: https://github.com/npm/cli/releases/tag/v11.6.3
npm notice To update run: npm install -g npm@11.6.3
npm notice




-----------------------------------------

npx npm install -D vite@latest @vitejs/plugin-vue2@latest

Создайте plugins/vite-pug.js (без внешних зависимостей)

// plugins/vite-pug.js
import { compileFile } from 'pug';
import { resolve } from 'path';

export default function vitePugPlugin(options = {}) {
  const { basedir = 'src/pug' } = options;

  return {
    name: 'vite-pug',
    enforce: 'pre',
    transformIndexHtml: {
      order: 'pre',
      handler(html, ctx) {
        const pathname = ctx.path;
        // Поддержка: / → index.pug, /about.html → about.pug
        if (pathname === '/' || pathname.endsWith('.html')) {
          const name = pathname === '/' ? 'index' : pathname.slice(1, -5);
          const pugPath = resolve(__dirname, `src/pug/views/${name}.pug`);
          try {
            const fn = compileFile(pugPath, {
              basedir: resolve(__dirname, basedir),
              pretty: false,
            });
            return fn(); // → HTML
          } catch (err) {
            return `<h2> Pug Error: ${name}.pug</h2><pre>${err.message}</pre>`;
          }
        }
        return html;
      }
    }
  };
}

------------------------

// vite.config.js
import { defineConfig } from 'vite';
import vue from '@vitejs/plugin-vue2';
import vitePugPlugin from './plugins/vite-pug.js';

export default defineConfig({
  plugins: [
    vue(),
    vitePugPlugin({ basedir: 'src/pug' })
  ],
  resolve: {
    alias: {
      vue: 'vue/dist/vue.esm.js',
      '@scss': 'src/scss',
      '@pug': 'src/pug'
    }
  },
  css: {
    preprocessorOptions: {
      scss: {
        // Если у вас глобальные @import (например, variables.scss), раскомментируйте:
        // additionalData: `@import "@/scss/variables.scss";`
      }
    }
  },
  server: {
    port: 5173,
    open: true, // откроет /
    fs: {
      allow: ['src', 'node_modules']
    }
  }
});

-------------------------------------------------

Создайте index.html в корне

<!-- index.html -->
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dev</title>
</head>
<body>
  <div id="app"></div>
  <script type="module" src="/src/js/index.js"></script>
</body>
</html>

---------------------------------------

"scripts": {
  "dev": "webpack --mode development && prettier --print-width=120 --parser html --write dist/*.html",
  "build": "webpack --mode production",
  "start": "webpack-dev-server --mode development --open",
  "dev:vite": "vite",
  "lint": "eslint --ext .js --ignore-path .gitignore ."
}

