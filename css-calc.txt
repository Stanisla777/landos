numberFormattingThousandths(count, e) {
  const target = e.target;
  let start = target.selectionStart;
  let end = target.selectionEnd;
  let valueBefore = target.value;

  // –ü–æ–ª—É—á–∞–µ–º "—Å—ã—Ä–æ–µ" –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Å–æ–±—ã—Ç–∏—è
  let rawValue = e.target.value;

  // –ï—Å–ª–∏ –ø–æ–ª–µ –ø—É—Å—Ç–æ–µ ‚Äî —Å–±—Ä–∞—Å—ã–≤–∞–µ–º
  if (!rawValue) {
    this.dataFieldIncome = '';
    return;
  }

  // –£–±–∏—Ä–∞–µ–º –≤—Å—ë –∫—Ä–æ–º–µ —Ü–∏—Ñ—Ä, —Ç–æ—á–∫–∏ –∏ –∑–∞–ø—è—Ç–æ–π
  let cleaned = rawValue.replace(/[^\d.,]/g, '');

  // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ª—É—á–∞—è, –∫–æ–≥–¥–∞ –≤–≤–µ–¥–µ–Ω–∞ —Ç–æ–ª—å–∫–æ –∑–∞–ø—è—Ç–∞—è/—Ç–æ—á–∫–∞
  if (cleaned === ',' || cleaned === '.') {
    this.dataFieldIncome = '0,';
    this.$nextTick(() => {
      target.setSelectionRange(2, 2); // –ø–æ—Å–ª–µ "0,"
    });
    return;
  }

  // –ó–∞–º–µ–Ω—è–µ–º –∑–∞–ø—è—Ç—É—é –Ω–∞ —Ç–æ—á–∫—É –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞
  let normalized = cleaned.replace(/,/g, '.');

  // –†–∞–∑–¥–µ–ª—è–µ–º –Ω–∞ —á–∞—Å—Ç–∏
  let parts = normalized.split('.');
  let integerPart = parts[0] || '0';
  let decimalPart = parts[1] ? parts[1].slice(0, 2) : '';

  // –°–æ–±–∏—Ä–∞–µ–º —á–∏—Å–ª–æ
  let numericStr = decimalPart ? `${integerPart}.${decimalPart}` : integerPart;
  let num = Number(numericStr);

  if (isNaN(num)) {
    this.dataFieldIncome = '';
    return;
  }

  // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ –º–∞–∫—Å–∏–º—É–º—É
  if (num > count) {
    num = count;
    num = Math.round(num * 100) / 100;
  }

  // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º
  const formatter = new Intl.NumberFormat('ru-RU', {
    minimumFractionDigits: decimalPart ? decimalPart.length : 0,
    maximumFractionDigits: 2
  });

  let formatted = formatter.format(num);

  // üî• –í–´–ß–ò–°–õ–Ø–ï–ú –ù–û–í–£–Æ –ü–û–ó–ò–¶–ò–Æ –ö–£–†–°–û–†–ê
  let newStart = this.calculateCursorPosition(valueBefore, formatted, start);
  let newEnd = newStart;

  // –û–±–Ω–æ–≤–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ
  this.dataFieldIncome = formatted;

  // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫—É—Ä—Å–æ—Ä
  this.$nextTick(() => {
    target.setSelectionRange(newStart, newEnd);
  });
},
calculateCursorPosition(oldValue, newValue, cursorPos) {
  // –£–±–∏—Ä–∞–µ–º –ø—Ä–æ–±–µ–ª—ã –∏–∑ –æ–±–æ–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è "–ª–æ–≥–∏—á–µ—Å–∫–æ–π" –ø–æ–∑–∏—Ü–∏–∏
  let oldClean = oldValue.replace(/\s/g, '');
  let newClean = newValue.replace(/\s/g, '');

  // –ù–∞—Ö–æ–¥–∏–º, —Å–∫–æ–ª—å–∫–æ —Å–∏–º–≤–æ–ª–æ–≤ –±—ã–ª–æ –¥–æ –∫—É—Ä—Å–æ—Ä–∞ –≤ "—á–∏—Å—Ç–æ–º" —Å—Ç–∞—Ä–æ–º –∑–Ω–∞—á–µ–Ω–∏–∏
  let charsBeforeCursor = oldClean.slice(0, cursorPos).length;

  // –¢–µ–ø–µ—Ä—å —Å—á–∏—Ç–∞–µ–º, –≥–¥–µ —ç—Ç–∞ –ø–æ–∑–∏—Ü–∏—è –≤ –Ω–æ–≤–æ–º –∑–Ω–∞—á–µ–Ω–∏–∏ (—Å —É—á—ë—Ç–æ–º –ø—Ä–æ–±–µ–ª–æ–≤)
  let newCursorPos = 0;
  let counted = 0;

  for (let i = 0; i < newValue.length; i++) {
    if (newValue[i] !== ' ') {
      if (counted === charsBeforeCursor) {
        break;
      }
      counted++;
    }
    newCursorPos++;
  }

  return newCursorPos;
},
