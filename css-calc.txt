npx webpack --config webpack.css.js --watch --mode development

npx webpack-dev-server --mode development --hot --config webpack.config.js

npm warn idealTree Removing dependencies.sass in favor of devDependencies.sass
npm notice
npm notice New major version of npm available! 10.7.0 -> 11.6.3
npm notice Changelog: https://github.com/npm/cli/releases/tag/v11.6.3
npm notice To update run: npm install -g npm@11.6.3
npm notice
npm error code E404
npm error 404 Not Found - GET https://nexus.ahml.ru/repository/npm-repo/@popeindustries%2fvite-plugin-pug - Not found
npm error 404
npm error 404  '@popeindustries/vite-plugin-pug@*' is not in this registry.
npm error 404
npm error 404 Note that you can also install from a
npm error 404 tarball, folder, http url, or git url.



npm install -D vite @vitejs/plugin-vue2 @popeindustries/vite-plugin-pug sass


// vite.config.js
import { defineConfig } from 'vite';
import vue from '@vitejs/plugin-vue2';
import pug from '@popeindustries/vite-plugin-pug';
import { resolve } from 'path';

export default defineConfig({
  plugins: [
    vue(),
    pug({
      // Опции Pug — те же, что в pug-loader
      pretty: false,
      basedir: resolve(__dirname, 'src/pug'),
    }),
  ],

  resolve: {
    alias: {
      // Поддержка Vue 2
      vue: 'vue/dist/vue.esm.js',
    },
  },

  css: {
    preprocessorOptions: {
      scss: {
        // Поддержка @import в SCSS без node_modules/
        additionalData: `@import "@/scss/variables.scss";` // ← если нужно глобальное
      }
    }
  },

  build: {
    // НЕ используется при dev, но на случай `vite build`
    outDir: 'dist-vite', // ← отдельная папка, чтобы не конфликтовать с Webpack
    rollupOptions: {
      input: {
        // Динамически генерируем входы из Pug
        ...Object.fromEntries(
          fs.readdirSync('src/pug/views')
            .filter(f => f.endsWith('.pug'))
            .map(f => [f.replace(/\.pug$/, ''), `src/pug/views/${f}`])
        )
      }
    }
  },

  server: {
    port: 5173,
    open: true,
    // Сервим статику как в Webpack
    fs: {
      allow: ['src', 'node_modules']
    }
  }
});

-----------------------------------------------
"scripts": {
  "dev": "webpack --mode development && prettier --print-width=120 --parser html --write dist/*.html",
  "build": "webpack --mode production",
  "start": "webpack-dev-server --mode development --open",
  "dev:vite": "vite",
  "lint": "eslint --ext .js --ignore-path .gitignore ."
}

<!-- index.html -->
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vite Dev</title>
</head>
<body>
  <!-- Pug-страницы будут рендериться сюда -->
  <div id="app"></div>
  <!-- Vite автоматически вставит скрипты -->
  <script type="module" src="/src/js/index.js"></script>
</body>
</html>

------------------------

npm run dev:vite

