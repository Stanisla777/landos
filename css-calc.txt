const positionTooltip = (element) => {
  const noteText = element.querySelector('.content-note__text');
  const computed = getComputedStyle(noteText);

  // === ðŸ” ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼: ÐµÑÐ»Ð¸ transform, left, top, right, bottom ÑƒÐ¶Ðµ Ð·Ð°Ð´Ð°Ð½Ñ‹ â€” Ð½Ðµ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¾Ð½Ð¸Ñ€ÑƒÐµÐ¼ ===
  const hasTransform = computed.transform && computed.transform !== 'none';
  const hasLeft = computed.left !== 'auto';
  const hasRight = computed.right !== 'auto';
  const hasTop = computed.top !== 'auto';
  const hasBottom = computed.bottom !== 'auto';

  // Ð•ÑÐ»Ð¸ Ñ…Ð¾Ñ‚Ñ Ð±Ñ‹ Ð¾Ð´Ð½Ð¾ Ð¸Ð· Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¾Ð½Ð¸Ñ€ÑƒÑŽÑ‰Ð¸Ñ… ÑÐ²Ð¾Ð¹ÑÑ‚Ð² Ð·Ð°Ð´Ð°Ð½Ð¾ â€” Ð½Ðµ Ñ‚Ñ€Ð¾Ð³Ð°ÐµÐ¼
  if (hasTransform || hasLeft || hasRight || hasTop || hasBottom) {
    // console.log('ÐŸÐ¾Ð·Ð¸Ñ†Ð¸Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾Ð¿ÑƒÑ‰ÐµÐ½Ð¾: ÑƒÐ¶Ðµ Ð·Ð°Ð´Ð°Ð½Ð¾ Ð² CSS/ÑÑ‚Ð¸Ð»ÑÑ…');
    return; // âŒ ÐÐµ Ð¿ÐµÑ€ÐµÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÐ¼
  }

  // === âœ… Ð•ÑÐ»Ð¸ Ð´Ð¾ÑˆÐ»Ð¸ ÑÑŽÐ´Ð° â€” Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¾Ð½Ð¸Ñ€ÑƒÐµÐ¼ ÐºÐ°Ðº Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾ ===
  const rect = element.getBoundingClientRect();
  const parent = element.parentElement;
  const parentPos = parent.getBoundingClientRect();
  const relativePosLeftElement = rect.left - parentPos.left;
  const windowWidth = window.innerWidth;
  const windowHeight = window.innerHeight;
  const parentWidth = parent.offsetWidth;
  const leftOffset = rect.left + rect.width / 2;
  const topOffset = rect.top + rect.height / 2;

  // Ð¡Ð±Ñ€Ð¾ÑÐ¸Ð¼ transform Ð´Ð»Ñ Ð¸Ð·Ð¼ÐµÑ€ÐµÐ½Ð¸Ñ (Ð½Ð° Ð²ÑÑÐºÐ¸Ð¹ ÑÐ»ÑƒÑ‡Ð°Ð¹)
  const originalTransform = noteText.style.transform;
  noteText.style.transform = 'none';
  const tooltipWidth = noteText.offsetWidth;
  noteText.style.transform = originalTransform;

  // ÐžÑ‡Ð¸ÑÑ‚Ð¸Ð¼ ÑÑ‚Ð°Ñ€Ñ‹Ðµ ÑÑ‚Ð¸Ð»Ð¸
  noteText.style.left = '';
  noteText.style.right = '';
  noteText.style.top = '';
  noteText.style.bottom = '';
  noteText.style.inset = '';
  noteText.style.transform = '';

  // === Ð“Ð¾Ñ€Ð¸Ð·Ð¾Ð½Ñ‚Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ===
  if (element.closest('.js--courses-accord-content') || element.closest('.js--element-overflow')) {
    if (windowWidth >= 600) {
      if (parentWidth / 2 < relativePosLeftElement) {
        noteText.style.left = 'auto';
        noteText.style.right = '-.25rem';
      } else {
        noteText.style.left = '.25rem';
        noteText.style.right = 'auto';
      }
    } else {
      noteText.style.inset = 'unset';
      noteText.style.transform = `translateX(${-((rect.left - tooltipWidth / 2 + 7) - (windowWidth / 2 - tooltipWidth / 2))}px)`;
    }
  } else {
    if (windowWidth >= 600) {
      if (windowWidth / 2 < leftOffset) {
        noteText.style.left = 'auto';
        noteText.style.right = '-.25rem';
      } else {
        noteText.style.left = '.25rem';
        noteText.style.right = 'auto';
      }
    } else {
      noteText.style.inset = 'unset';
      noteText.style.transform = `translateX(${-((rect.left - tooltipWidth / 2 + 7) - (windowWidth / 2 - tooltipWidth / 2))}px)`;
    }
  }

  // === Ð’ÐµÑ€Ñ‚Ð¸ÐºÐ°Ð»ÑŒÐ½Ð¾Ðµ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ===
  if (element.closest('.js--courses-accord-content') || element.closest('.js--element-overflow')) {
    const notesParentBounding = element.closest('.js--courses-accord-content')?.getBoundingClientRect();
    if (notesParentBounding) {
      const locationDifference = rect.top - notesParentBounding.top;
      const heightTooltip = noteText.offsetHeight;
      if (heightTooltip >= locationDifference) {
        noteText.style.top = 'calc(100% + .25rem)';
        noteText.style.bottom = 'auto';
      } else if (heightTooltip < locationDifference && windowHeight / 2 < topOffset) {
        noteText.style.top = 'auto';
        noteText.style.bottom = 'calc(100% + .25rem)';
      } else {
        noteText.style.top = 'calc(100% + .25rem)';
        noteText.style.bottom = 'auto';
      }
    }
  } else {
    if (windowHeight / 2 > topOffset) {
      noteText.style.top = 'calc(100% + .25rem)';
      noteText.style.bottom = 'auto';
    } else {
      noteText.style.top = 'auto';
      noteText.style.bottom = 'calc(100% + .25rem)';
    }
  }
};
